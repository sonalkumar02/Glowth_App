<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Glowth</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
    <style>
        html{
            scroll-behavior: smooth;
        }
        
        :root {
            --peach: #ffd6c4;
            --lavender: #e2d1f9;
            --coral: #ff8b8b;
            --mint: #98ffb3;
            --sky: #a8d8ff;
        }

        /* Why protection matter box */
        .perspective {
            perspective: 1000px;
        }
        .flip-card {
            transition: transform 0.6s;
            transform-style: preserve-3d;
            position: relative;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        .flip-card-inner {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 1rem;
            padding: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .flip-card-front {
            background-color: #fef3c7;
        }
        .flip-card-back {
            background-color: #ddd6fe;
            transform: rotateY(180deg);
        }
        .flip-card.flipped {
            transform: rotateY(180deg);
        }
        /* end of why protection matter */
       
        /* for AM, PM & Hydration Plan */
        .task.done {
            position: relative;
            color: #aaa;
        }
        .task.done::after {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            top: 50%;
            height: 2px;
            background: #a78bfa; /* light purple */
            animation: strike 0.4s ease-out forwards;
        }

        @keyframes strike {
            from { width: 0; }
            to { width: 100%; }
        }
        /* End of for AM, PM & Hydration Plan */

        /* custome text font-family and styling for bento league box */
        .custom-skin-text {
            font-family: 'Baloo 2', cursive;
            font-size: 1.5rem; /* bigger size */
            font-weight: 700; /* bold */
            color: #09122C ; /* purple-ish, playful */
        }
        /* End of custome text font-family and styling for bento league box */



        /* Css for animated character */
        .character {
        animation: floaty 4s ease-in-out infinite;
        }

        .head {
        width: 70px;
        height: 70px;
        background: #ffe0b2;
        border-radius: 50%;
        position: relative;
        margin: 0 auto;
        }

        /* Eyes */
        .eye {
        width: 10px;
        height: 10px;
        background: black;
        border-radius: 50%;
        position: absolute;
        top: 25px;
        animation: blink 4s infinite;
        }
        .eye.left {
        left: 18px;
        }
        .eye.right {
        right: 18px;
        }

        /* Eyebrows */
        .eyebrow {
        width: 14px;
        height: 4px;
        background: #5d4037;
        position: absolute;
        top: 16px;
        border-radius: 2px;
        }
        .eyebrow.left {
        left: 14px;
        transform: rotate(-10deg);
        }
        .eyebrow.right {
        right: 14px;
        transform: rotate(10deg);
        }

        /* Nose */
        .nose {
        width: 8px;
        height: 8px;
        background: #ef9a9a;
        border-radius: 50%;
        position: absolute;
        top: 35px;
        left: 50%;
        transform: translateX(-50%);
        }

        /* Mouth */
        .mouth {
        width: 16px;
        height: 6px;
        background: #d84315;
        border-radius: 3px;
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        }

        /* Body */
        .body {
        width: 60px;
        height: 80px;
        background: #90caf9;
        border-radius: 20px;
        position: relative;
        margin: 0 auto;
        }

        /* Arms */
        .arm {
        width: 16px;
        height: 40px;
        background: #90caf9;
        position: absolute;
        top: 10px;
        }
        .arm.left {
        left: -16px;
        transform: rotate(10deg);
        }
        .arm.right {
        right: -16px;
        transform: rotate(-10deg);
        }

        /* Hands */
        .hand {
        width: 16px;
        height: 16px;
        background: #ffe0b2;
        border-radius: 50%;
        position: absolute;
        bottom: -8px;
        left: 0;
        right: 0;
        margin: auto;
        }
        .thumb {
        width: 4px;
        height: 8px;
        background: #ffe0b2;
        position: absolute;
        left: -4px;
        top: 4px;
        border-radius: 4px;
        }
        .fingers {
        width: 10px;
        height: 6px;
        background: #ffe0b2;
        position: absolute;
        right: -4px;
        top: 4px;
        border-radius: 6px;
        }

        /* Legs */
        .leg {
        width: 14px;
        height: 40px;
        background: #90caf9;
        position: absolute;
        bottom: -40px;
        }
        .leg.left {
        left: 8px;
        }
        .leg.right {
        right: 8px;
        }

        /* Socks */
        .sock {
        width: 14px;
        height: 8px;
        background: #fff;
        position: absolute;
        bottom: 16px;
        }

        /* Shoes */
        .shoe {
        width: 16px;
        height: 12px;
        background: #37474f;
        position: absolute;
        bottom: 0;
        border-radius: 4px;
        }

        /* Animations */
        @keyframes blink {
        0%, 97%, 100% { height: 10px; }
        98% { height: 1px; }
        99% { height: 10px; }
        }

        @keyframes floaty {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-4px); }
        }

        /* End of Css for animated character */




        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes typewriter {
            from { width: 0; }
            to { width: 100%; }
        }
        @keyframes glowPulse {
            0% { box-shadow: 0 0 5px var(--coral); }
            50% { box-shadow: 0 0 20px var(--coral); }
            100% { box-shadow: 0 0 5px var(--coral); }
        }
        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        @keyframes coinPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        @keyframes coinShine {
            0% { text-shadow: 0 0 5px rgba(255, 215, 0, 0.5); }
            50% { text-shadow: 0 0 20px rgba(255, 215, 0, 0.8); }
            100% { text-shadow: 0 0 5px rgba(255, 215, 0, 0.5); }
        }

        body { 
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            font-family: 'Inter', sans-serif;
        }

        /* sidebar css */

        .sidebar-icon {
            transition: all 0.3s ease;
            position: relative;
            background: linear-gradient(135deg, var(--lavender) 0%, var(--sky) 100%);
            border-radius: 12px;
            padding: 12px;
            color: #4a5568;
        }
        .sidebar-icon:hover {
            transform: scale(1.15) rotate(-8deg);
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        .sidebar-icon::after {
            content: attr(data-tooltip);
            position: absolute;
            left: 100%;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .sidebar-icon:hover::after {
            opacity: 1;
        }
        .active-icon {
            background: linear-gradient(135deg, var(--coral) 0%, var(--peach) 100%) !important;
            color: white !important;
            animation: pulse 2s infinite;
        }
        .sidebar { 
            min-width: 70px;
            background: white;
            box-shadow: 2px 0 8px rgba(0,0,0,0.05);
        }

        /* end of sidebar */

        .main-bg { 
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
        }
        .bento-card {
            background: white;
            border-radius: 20px;
            transition: all 0.3s ease;
            animation: slideIn 0.5s ease-out;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            border: 1px solid rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
            margin: 1rem;
            padding: 1.5rem;
            text-align: center;
        }
        .bento-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--peach), var(--coral), var(--lavender));
            background-size: 200% 100%;
            animation: gradientFlow 3s ease infinite;
        }
        .bento-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        .bento-card.large {
            grid-column: span 2;
        }
        .bento-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        .bento-grid2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0rem;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0rem;
        }
        .right-panel { 
            background: white;
            box-shadow: -2px 0 8px rgba(0,0,0,0.05);
            border-left: 1px solid rgba(0,0,0,0.05);
            padding: 2rem;
        }
        .glow-score {
            background: linear-gradient(135deg, var(--coral) 0%, var(--peach) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s infinite;
        }
        .streak-badge {
            background: linear-gradient(135deg, var(--coral) 0%, var(--peach) 100%);
            border-radius: 9999px;
            padding: 0.75rem 1.5rem;
            font-weight: bold;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            animation: pulse 2s infinite;
            box-shadow: 0 4px 12px rgba(255,139,139,0.3);
            margin: 0.5rem;
            cursor: pointer;
            transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
        }
        .streak-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255,139,139,0.5);
        }
        .streak-badge:active, .streak-badge.clicked {
            transform: translateY(1px);
            box-shadow: 0 2px 8px rgba(255,139,139,0.3);
            background: linear-gradient(135deg, #ff7b7b 0%, #ffc1a6 100%);
        }
        .glow-coin {
            background: linear-gradient(135deg, #ffd700 0%, #ff9a8b 100%);
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            box-shadow: 0 4px 12px rgba(255,154,139,0.3);
            margin: 0.5rem;
        }
        .progress-bar {
            height: 8px;
            background: #f3f4f6;
            border-radius: 4px;
            overflow: hidden;
            margin: 1rem 0;
        }
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--coral) 0%, var(--peach) 100%);
            transition: width 1s ease;
            animation: glowPulse 2s infinite;
        }
        .skin-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            color: white;
            margin: 1rem;
            box-shadow: 0 8px 32px rgba(255,139,139,0.3);
            animation: float 3s ease-in-out infinite;
            position: relative;
        }
        .skin-avatar::after {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--coral) 0%, var(--peach) 100%);
            opacity: 0.3;
            filter: blur(8px);
            animation: pulse 2s infinite;
        }
        .quest-card {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            margin: 1rem 0;
            border: 1px solid rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .quest-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        .mood-button {
            transition: all 0.3s ease;
            background: white;
            border: 1px solid rgba(0,0,0,0.05);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            margin: 0.5rem;
            padding: 0.75rem 1.5rem;
        }
        .mood-button:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        .product-card {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            margin: 1rem 0;
            border: 1px solid rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        .typewriter {
            overflow: hidden;
            white-space: nowrap;
            animation: typewriter 2s steps(40) 1s forwards;
        }
        #glowbot-chatbox 
        {
                position: fixed;
                bottom: 20px;
                left: 20px;
                width: 300px;
            height: 400px;
                background: white;
                border: 1px solid #ccc;
                border-radius: 12px;
                box-shadow: 0 8px 16px rgba(0,0,0,0.2);
                display: flex;
                flex-direction: column;
                z-index: 1000;
                font-family: 'Segoe UI', sans-serif;
            }

            #glowbot-chat-header {
                padding: 10px;
                background: linear-gradient(to right, #3D365C, #3C0061);
                color: white;
                display: flex;
                justify-content: space-between;
                align-items: center;
                border-top-left-radius: 12px;
                border-top-right-radius: 12px;
            }

            #glowbot-messages {
                flex: 1;
                padding: 10px;
            overflow-y: auto;
                font-size: 14px;
                display: flex;
                flex-direction: column;
                justify-content: flex-end;
            }

            #glowbot-input {
                display: flex;
                padding: 10px;
                border-top: 1px solid #eee;
            }

            #glowbot-input input {
                flex: 1;
                padding: 6px;
                border: 1px solid #ccc;
                border-radius: 6px;
            }

            #glowbot-input button {
                margin-left: 6px;
                background-color: #3C0061;
                color: white;
                border: none;
                border-radius: 6px;
                padding: 6px 10px;
                cursor: pointer;
            }

            .glowbot-msg-user { text-align: right; margin: 4px 0; }
            .glowbot-msg-bot { text-align: left; margin: 4px 0; color: #3C0061; 
        }
        .glowbot-message {
            position: relative;
            padding: 1.5rem;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.05);
            margin: 1rem 0;
        }
        .glowbot-message::before {
            content: 'üí¨';
            position: absolute;
            left: 0.5rem;
            top: 0.5rem;
            animation: bounce 1s infinite;
        }
        .find-twin-button {
            background: linear-gradient(135deg, var(--coral) 0%, var(--peach) 100%);
            color: white;
            border-radius: 12px;
            padding: 1rem 2rem;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(255,139,139,0.3);
            animation: glowPulse 2s infinite;
            margin: 1rem 0;
        }
        .find-twin-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(255,139,139,0.4);
        }
        .card-emoji {
            font-size: 1.5rem;
            margin-right: 1rem;
            animation: bounce 2s infinite;
        }
        .card-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.5rem;
            padding: 0.5rem;
        }
        .card-content {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 1.5rem;
            height: calc(100% - 3rem);
            text-align: center;
        }
        .weather-warning {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeeba 100%);
            border-left: 4px solid #ffc107;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        .skin-twin-match {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-left: 4px solid #28a745;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        /* Indian Skin Analysis button style */
        button[id^="skin-scan-btn-main"] {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: block !important;
            background: linear-gradient(135deg, var(--coral) 0%, var(--peach) 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(255,139,139,0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        button[id^="skin-scan-btn-main"]:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255,139,139,0.4);
        }
        button[id^="skin-scan-btn-main"].clicked {
            transform: translateY(1px);
            box-shadow: 0 2px 8px rgba(255,139,139,0.3);
        }
        .user-stats {
            padding: 1.5rem;
            margin: 1rem;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: relative;
            text-align: center;
        }
        .user-stats::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 20px;
            background: linear-gradient(135deg, var(--coral) 0%, var(--peach) 100%);
            opacity: 0.3;
            filter: blur(8px);
            z-index: -1;
        }
        /* league box styling */
        .league-box {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            position: relative;
            }

        .league-box::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 20px;
            background: linear-gradient(135deg, #d8b4fe  0%, #c084fc  100%);
            opacity: 0.4;
            filter: blur(8px);
            z-index: -1;
        }

        .coin-earned {
            animation: coinPulse 0.5s ease-in-out 3, coinShine 1.5s ease-in-out;
            color: #FFD700 !important;
        }
        @media (max-width: 1024px) {
            .bento-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1.5rem;
                padding: 1.5rem;
            }
            .bento-card.large {
                grid-column: span 1;
            }
        }
        @media (max-width: 768px) {
            .bento-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
                padding: 1rem;
            }
            .right-panel {
                display: none;
            }
            .main-content {
                margin-right: 0;
            }
            .bento-card {
                margin: 0.5rem;
                padding: 1rem;
            }
        }
        /* Goals Styles */
        .goal-item {
            background: #fff;
            border-radius: 12px;
                padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .goal-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .goal-emoji {
            display: inline-block;
            transition: transform 0.2s ease;
        }

        .goal-emoji:hover {
            transform: scale(1.2);
        }

        .goal-chest {
            transition: all 0.3s ease;
        }

        .goal-chest.closed {
            opacity: 0.7;
        }

        .goal-chest.open {
            animation: chestOpen 0.5s ease-out;
        }

        .goal-chest.open .chest-emoji {
            animation: chestBounce 0.5s ease-out;
        }

        @keyframes chestOpen {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        @keyframes chestBounce {
            0% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }

        .progress-bar {
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF6B6B, #FF8E53);
            transition: width 0.3s ease;
        }

        /* Celebration Animation */
        @keyframes celebrate {
            0% { transform: scale(1); }
            25% { transform: scale(1.1) rotate(-5deg); }
            50% { transform: scale(1.1) rotate(5deg); }
            75% { transform: scale(1.1) rotate(-5deg); }
            100% { transform: scale(1); }
        }

        .celebrating {
            animation: celebrate 0.5s ease-out;
        }

        /* Confetti Animation */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
        }

        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        /* Sound Button */
        .sound-toggle {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: #fff;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .sound-toggle:hover {
            transform: scale(1.1);
        }

        .sound-toggle.muted {
            opacity: 0.5;
        }

        @keyframes fade-in {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-float {
            animation: float 3s ease-in-out infinite;
        }
        .animate-fade-in {
            animation: fade-in 0.5s ease-out;
        }
        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .product-card:hover {
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }
        /* Add these styles for the switch toggle */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
        }
        input:checked + .slider {
            background-color: #3C0061;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        .slider.round {
            border-radius: 34px;
        }
        .slider.round:before {
            border-radius: 50%;
        }
        /* Add this to ensure the button is visible */
        #quick-scan-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: block !important;
            background: linear-gradient(135deg, var(--coral) 0%, var(--peach) 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(255,139,139,0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #quick-scan-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255,139,139,0.4);
        }

        #quick-scan-btn.clicked {
            transform: translateY(1px);
            box-shadow: 0 2px 8px rgba(255,139,139,0.3);
        }

        /* Add these styles for the camera modal */
        .camera-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .camera-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            position: relative;
        }

        .camera-view {
            width: 100%;
            height: 400px;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .camera-view video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .capture-btn {
            background: linear-gradient(135deg, var(--coral) 0%, var(--peach) 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: bold;
            width: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .capture-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255,139,139,0.4);
        }

        .close-camera {
            position: absolute;
            top: 10px;
            right: 10px;
            background: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        /* clash check and suggested fix  */
        .bento-box{
            min-height: 500px;
        }
        @keyframes bounceSlow {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
        }

        .animate-bounce-slow {
        animation: bounceSlow 2s infinite;
        }
        .skin-btn {
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            font-weight: 500;
            color: #333;
            transition: all 0.3s ease-in-out;
        }
        .skin-btn:hover {
            background: #ffe4e6;
            border-color: #f43f5e;
            color: #d70040;
            transform: scale(1.05);
        }
        .skin-btn.active {
            background: #f43f5e;
            color: white;
            border-color: #f43f5e;
        }

        /* end of clash check and suggested fix */

        /* Update the image preview styles */
        .preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .preview-item {
            position: relative;
            width: 100px;
            height: 100px;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .preview-item .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        
        .loading-spinner {
            display: none;
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Shop Bento Custom Styles */
        .shop-bento {
          background: linear-gradient(135deg, #fff7f0 0%, #f3e8ff 100%);
          border: 2px solid #f3e8ff;
          box-shadow: 0 4px 24px rgba(255,139,139,0.08);
        }
        .shop-search-bar {
          min-width: 260px;
          max-width: 400px;
          font-size: 1.1rem;
          margin-bottom: 0;
        }
        .shop-filter-bar {
          min-width: 120px;
          max-width: 180px;
          font-size: 1rem;
        }

        /* for customer favorite products carousel */
        .cursor-grabbing {
            cursor: grabbing;
            cursor: -webkit-grabbing;
        }
        /* end of customer favorite products carousel */


        /* liquid glass effect in button */
        .backdrop-blur-md {
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }
    </style>
    
</head>
<body class="flex min-h-screen">
    <!-- Sidebar -->
    <aside class="sidebar flex flex-col items-center py-6 space-y-4 h-screen fixed left-0 top-0 z-20">
        <div class="mb-8">
            <span class="text-3xl">‚ú®</span>
        </div>
        <button class="sidebar-icon active-icon" data-page="home" data-tooltip="Home" id="icon-home">üè†</button>
        <button class="sidebar-icon" data-page="goals" data-tooltip="Goals" id="icon-goals">üéØ</button>
        <button class="sidebar-icon" data-page="glowshield" data-tooltip="Glow Shield" id="icon-glowshield">üõ°Ô∏è</button>
        <button class="sidebar-icon" data-page="GlowPro" data-tooltip="GlowPro" id="icon-glowpro">üíé</button>
        <button class="sidebar-icon" data-page="profile" data-tooltip="Profile" id="icon-profile">üßë‚Äçüíº</button>
        <button class="sidebar-icon" data-page="shop" data-tooltip="Shop" id="icon-shop">üõçÔ∏è</button>
    </aside>

    <!-- Main Content Area -->
    <main class="flex-1 ml-[70px] mr-[350px] p-8 main-bg min-h-screen">
        <div id="main-content" class="main-content-center">
            <!-- Emoji Counters Row -->
            <div class="flex items-center justify-end space-x-8 mt-2 pr-2" style="background: rgba(255,255,255,0.0); padding: 10px 20px;">
                <span class="flex items-center text-lg font-semibold bg-white">
                  <span class="mr-1 text-2xl">üî•</span><span class="daily-streak-count">0</span>
                </span>
                <span class="flex items-center text-lg font-semibold bg-white">
                  <span class="mr-1 text-2xl">‚ú®</span><span class="glow-coin-count">0</span>
                </span>
                <span class="flex items-center text-lg font-semibold bg-white">
                  <span class="mr-1 text-2xl">üíß</span><span class="hydration-count">0</span>
                </span>
            </div>
            <!-- User Stats Bar -->
            <div class="flex justify-center space-x-6 p-4">
                <!-- bento user box 1 -->
                <div class="user-stats w-full max-w-2xl mb-8 flex items-left justify-between bg-white p-6 rounded-2xl shadow-md">
                <div class="flex items-center space-x-4">
                    <div class="skin-avatar">
                      <i class="fas fa-user"></i>
                </div>
                    <div>
                      <h2 class="text-xl font-bold text-gray-800" id="greeting-text">Good Morning, Glow Seeker!</h2>
                      
                        <div class="flex items-left space-x-2 mt-1">
                            <span class="streak-badge cursor-pointer" id="skinScanBtn" onclick="initiateSkinScan()">üî•Quick Scan</span>
                        </div>
                    </div>
                </div>
                </div>
                <!-- bento league box 2 -->
                <div class="user-stats league-box w-full max-w-md mb-8 flex items-left justify-between rounded-2xl shadow-md">
                    <div class="flex items-center space-x-4">
                        <div class="skin-avatar">
                            <i class="fas fa-award text-yellow-500 text-4xl"></i>
                        </div>
                        <div>
                          <h2 class="text-xl font-bold text-gray-800", id="greeting-text">League</h2>
                          
                        <div class="flex items-left space-x-2 mt-1">
                            <span class="custom-skin-text">Comming soon</span>
                        </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Goals Page -->
        <div id="goals-page" class="page-content" style="display: none;">
            <div class="max-w-7xl mx-auto">
                
                <!-- Monthly Quest Section -->
                <div class="flex flex-col md:flex-row gap-6 mb-8">

                    <!-- May Quest Bento Box -->
                    <div class="bento-card flex-1 bg-gradient-to-br from-blue-50 to-teal-100 p-6 rounded-2xl shadow-md transform hover:scale-[1.02] transition-all duration-300 relative">
                    <!-- Top Bar -->
                    <div class="absolute top-4 left-4 bg-green-400 text-white text-xl px-4 py-2 rounded-md shadow-sm uppercase tracking-widest font-semibold" id="monthly-quest-month">
                        <!-- JS will fill month -->
                    </div>
                
                    <!-- Title and Description -->
                    <div class="mt-16 space-y-4">
                        <div>
                            <h2 class="text-2xl font-bold text-gray-800 text-left" id="monthly-quest-title">The Dewy Dash</h2>
                            <p class="text-sm text-gray-600 mt-1 text-left">üïõ <span id="monthly-quest-days-left"></span> days</p>
                        </div>
                        <!-- Combined Progress Section -->
                        <div class="bg-white/60 backdrop-blur-sm rounded-xl p-4 shadow-inner transition-all duration-300">
                            <div class="space-y-2">
                            <!-- Progress Label -->
                            <div class="flex items-center justify-between">
                                <h2 class="text-sm text-gray-800 font-medium">Complete <span id="monthly-quest-total">40</span> Quests</h2>
                                <div class="text-yellow-500 text-xl">üèÖ</div>
                            </div>
                        
                            <!-- Progress Bar -->
                            <div class="relative w-full bg-gray-200 h-5 rounded-full">
                                <div class="absolute top-0 left-0 h-5 bg-blue-500 rounded-full" id="monthly-quest-progress-bar" style="width: 0%;"></div>
                            </div>
                            </div>
                        </div>
                    </div>
                    </div>
                
                    <!-- Monthly Badges Box -->
                    <div class="bento-card w-full max-w-xs bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-md transform hover:scale-[1.02] transition-all duration-300">
                    <div class="card-header flex items-center gap-2 mb-4">
                        <span class="card-emoji text-xl animate-bounce">üéñÔ∏è</span>
                        <h3 class="text-lg font-bold text-gray-800 dark:text-gray-100">Monthly Badges</h3>
                    </div>
                    
                    <!-- Badges -->
                    <div class="space-y-4">
                        <!-- Badge 1 -->
                        <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-yellow-100 flex items-center justify-center text-lg rounded-full shadow-md">üåü</div>
                        <div class="flex-1">
                            <p class="font-medium text-gray-700">First Quest</p>
                            <p class="text-sm text-gray-500">Completed</p>
                        </div>
                        </div>
                
                        <!-- Badge 2 -->
                        <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-pink-100 flex items-center justify-center text-lg rounded-full shadow-md">üèÖ</div>
                        <div class="flex-1">
                            <p class="font-medium text-gray-700">XP Champion</p>
                            <p class="text-sm text-gray-500">Unlocked</p>
                        </div>
                        </div>
                    </div>
                    </div>
                
                </div>
                
                <!-- Daily Goals Section -->
                <div class="bento-card small">
                    <div class="card-header">
                        <span class="card-emoji">üéØ</span>
                        <h3 class="text-xl font-bold text-gray-800">Skin Goals</h3>
                    </div>
                    <div>
                        <div class="goals-container space-y-4">
                            <!-- Scan Goal -->
                            <div data-goal="scan">
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center space-x-3">
                                        <span class="goal-emoji text-2xl">üì∏</span>
                                        <span class="goal-text">Earn 10 XP</span>
                                    </div>
                                    <div class="goal-chest closed" data-goal="scan">
                                        <span class="chest-emoji text-2xl">üéÅ</span>
                                    </div>
                                </div>
                                <div class="progress-bar relative w-full bg-gray-200 rounded-full overflow-hidden" style="height: 30px;">
                                    <div class="progress-bar-fill absolute top-0 left-0 bg-purple-500 rounded-l-full" style="width: 0%; height: 100%;"></div>
                                    <div class="goal-progress absolute inset-0 flex items-center justify-center text-sm z-10 text-base">0/10</div>
                                </div>
                            </div>

                            <!-- Hydration Goal -->
                            <div data-goal="hydration">
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center space-x-3">
                                        <span class="goal-emoji text-2xl cursor-pointer hover:scale-110 transition-transform">üíß</span>
                                        <span class="goal-text">Earn 10 XP for Hydrated</span>
                                    </div>
                                    <div class="goal-chest closed" data-goal="hydration">
                                        <span class="chest-emoji text-2xl">üéÅ</span>
                                    </div>
                                </div>
                                <div class="progress-bar relative w-full bg-gray-200 rounded-full overflow-hidden" style="height: 30px;">
                                    <div class="progress-bar-fill absolute top-0 left-0 bg-purple-500 rounded-l-full" style="width: 0%; height: 100%;"></div>
                                    <div class="goal-progress absolute inset-0 flex items-center justify-center text-sm z-10 text-base">0/10</div>
                                </div>
                            </div>

                            <!-- Pollution Report Goal -->
                            <div data-goal="pollution">
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center space-x-3">
                                        <span class="goal-emoji text-2xl">üå§Ô∏è</span>
                                        <span class="goal-text">Check Pollution Report</span>
                                    </div>
                                    <div class="goal-chest closed" data-goal="pollution">
                                        <span class="chest-emoji text-2xl">üéÅ</span>
                                    </div>
                                </div>
                                <div class="progress-bar relative w-full bg-gray-200 rounded-full overflow-hidden" style="height: 30px;">
                                    <div class="progress-bar-fill absolute top-0 left-0 bg-purple-500 rounded-l-full" style="width: 0%; height: 100%;"></div>
                                    <div class="goal-progress absolute inset-0 flex items-center justify-center text-sm z-10 text-base">Not Completed Yet</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Glow Shield Page -->
        <div id="glowshield-page" class="page-content" style="display: none;">
            <div class="max-w-7xl mx-auto p-8">
                
                <!-- Skin Threat Meter -->
                <div class="bento-card w-full mb-6 transform hover:scale-[1.02] transition-all duration-300 flex justify-between items-center">
                    <div class="flex-1">
                    <div class="card-header">
                        <span class="card-emoji animate-bounce">üå§Ô∏è</span>
                        <h3 class="text-xl font-bold text-gray-800">Skin Threat Meter</h3>
                    </div>
                        <div>
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- UV Index Card -->
                            <div class="bg-gradient-to-r from-red-50 to-orange-50 p-4 rounded-lg transform hover:scale-105 transition-all duration-300">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-lg font-semibold">UV Index</span>
                                        <span class="text-xl font-bold text-orange-600" id="uv-value">--</span>
                                </div>
                                    <div class="text-sm text-orange-600 font-medium" id="uv-risk">Calculating...</div>
                                    
                            </div>

                            <!-- Air Quality Card -->
                            <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-4 rounded-lg transform hover:scale-105 transition-all duration-300">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-lg font-semibold">Air Quality</span>
                                        <span class="text-xl font-bold text-purple-600" id="aqi-value">--</span>
                                </div>
                                    <div class="text-sm text-purple-600 font-medium" id="aqi-risk">Calculating...</div>
                                    
                                    </div>

                                <!-- Humidity Card -->
                                <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-4 rounded-lg transform hover:scale-105 transition-all duration-300">
                                    <div class="flex items-center justify-between mb-2">
                                        <span class="text-lg font-semibold">Humidity</span>
                                        <span class="text-xl font-bold text-purple-600" id="humidity-value">--</span>
                                </div>
                                    <div class="text-sm text-purple-600 font-medium" id="humidity-risk">Calculating...</div>
                                    
                            </div>
                        </div>

                        <!-- Shield Visual -->
                        <div class="mt-4 text-center">
                                <button onclick="fetchPollutionData(); if (window.gamification) window.gamification.updateProtectionAchievement();" class="inline-block p-4 rounded-full bg-gradient-to-r from-blue-100 to-purple-100 border-4 border-blue-200 hover:scale-105 transition-transform duration-200 focus:outline-none">
                                    <div class="shield-visual animate-pulse">
                                üõ°Ô∏è
                            </div>
                                </button>
                            </div>
                        </div>
                    </div>  
                    <!-- Right: Animated Character -->
                    <div class="w-28 sm:w-32 md:w-40 relative flex justify-center items-center">
                        <div class="character relative">
                          <div class="head">
                            <div class="eyebrow left"></div>
                            <div class="eyebrow right"></div>
                            <div class="eye left"></div>
                            <div class="eye right"></div>
                            <div class="nose"></div>
                            <div class="mouth"></div>
                          </div>
                          <div class="body">
                            <div class="arm left">
                                <div class="hand">
                                    <div class="finger"></div>
                                    <div class="thumb"></div>
                                </div>
                            </div>
                            <div class="arm right">
                                <div class="hand">
                                    <div class="finger"></div>
                                    <div class="thumb"></div>
                                </div>
                            </div>
                            <div class="leg left">
                                <div class="sock"></div>
                                <div class="shoe"></div>
                            </div>
                            <div class="leg right">
                                <div class="sock"></div>
                                <div class="shoe"></div>
                            </div>
                            
                          </div>
                        </div>
                    </div>
                </div>

                <!-- Face Pollution Map -->
                <div class="bento-card mb-6 transform hover:scale-[1.02] transition-all duration-300">
                    <div class="card-header">
                        <span class="card-emoji animate-bounce">üßë‚Äçü¶∞</span>
                        <h3 class="text-xl font-bold text-gray-800">Face Pollution Map</h3>
                    </div>
                    <div class="card-content">
                        <div id="face-map-container" class="relative w-full max-w-3xl mx-auto overflow-hidden rounded-xl bg-gray-100 p-2"></div>
                    </div>
                </div>

                <!-- Recommended Product Carousel & Skin Forecast -->
                <div class="flex flex-col md:flex-row gap-6 w-full">
                    <!-- Recommended Protection Plan Bento -->
                    <div class="bento-card flex-1 mb-6 transform hover:scale-[1.02] transition-all duration-300">
                        <div class="card-header mb-4 flex items-center gap-2">
                          <span class="card-emoji animate-bounce text-2xl">üß¥</span>
                          <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Recommended Products</h3>
                        </div>
                      
                        <!-- Horizontal Scroll Carousel -->
                        <div class="overflow-x-auto scroll-smooth hide-scrollbar px-5 py-6">
                          <div id="product-carousel" class="flex gap-6 pr-2">
                      
                            <!-- Product Card 1 -->
                            <div class="flex-shrink-0 w-[600px] w-full h-72 flex items-center gap-6 p-4 bg-white dark:bg-gray-800 rounded-xl ">
                              <!-- Image -->
                              <img src="../assets/product1.jpg" alt="Sunscreen" class="w-72 h-64" />
                      
                              <!-- Info Section -->
                              <div class="w-full h-full flex flex-col justify-between">

                                <!-- Top Badge -->
                                <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full font-semibold animate-pulse mb-1 inline-block">
                                  üåü Best Seller
                                </span>
                              
                                <!-- Product Info -->
                                <div>
                                  <h4 class="text-xl font-bold text-pink-700 text-left">GlowGuard SPF 50</h4>
                                  <p class="text-sm text-gray-600 dark:text-gray-300 mt-1 text-left">
                                    Great for oily and acne-prone skin. Broad-spectrum protection.
                                  </p>
                                  <span class="inline-flex items-center text-[11px] font-medium bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full mt-2 w-fit shadow-sm">
                                    üíß Skin Type: Oily
                                  </span>                                  
                                </div>
                              
                                <!-- Divider -->
                                <div class="border-t border-gray-300 my-3"></div>
                              
                                <!-- Price + Reward + Button -->
                                <div class="flex items-center justify-between">
                                  <div class="flex flex-col">
                                    <span class="text-pink-600 font-semibold text-base">‚Çπ499</span>
                                  </div>
                                  <a href="https://www.amazon.in/dp/example1" target="_blank" class="bg-pink-600 text-white text-sm px-3 py-3 rounded-md hover:bg-pink-700 shadow hover:scale-105 transition-all duration-200 ease-in-out">
                                    üõí Buy Now
                                  </a>
                                </div>
                              </div>
                            </div>
                      
                            <!-- Product Card 2 -->
                            <div class="flex-shrink-0 w-[600px] w-full h-72 flex items-center gap-6 p-4 bg-white dark:bg-gray-800 rounded-xl ">
                                <!-- Image -->
                                <img src="../assets/de-tan.png" alt="Sunscreen" class="w-72 h-64" />
                        
                                <!-- Info Section -->
                                <div class="w-full h-full flex flex-col justify-between">
  
                                  <!-- Top Badge -->
                                  <span class="text-xs bg-red-100 text-red-700 px-2 py-0.5 rounded-full font-semibold animate-pulse mb-1 inline-block">
                                    üî• Hot Pick
                                  </span>                                  
                                
                                  <!-- Product Info -->
                                  <div>
                                    <h4 class="text-xl font-bold text-pink-700 text-left">Vitamin C Shield Serum</h4>
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mt-1 text-left">
                                        Fights pollution and boosts glow. Use in the morning routine.
                                    </p>
                                    <span class="inline-flex items-center text-[11px] font-medium bg-green-50 text-green-700 px-2 py-0.5 rounded-full mt-2 w-fit">
                                        üåøCombination
                                      </span>                                                                       
                                  </div>
                                
                                  <!-- Divider -->
                                  <div class="border-t border-gray-300 my-3"></div>
                                
                                  <!-- Price + Reward + Button -->
                                  <div class="flex items-center justify-between">
                                    <div class="flex flex-col">
                                      <span class="text-pink-600 font-semibold text-base">‚Çπ499</span>
                                    </div>
                                    <a href="https://www.amazon.in/dp/example1" target="_blank" class="bg-pink-600 text-white text-sm px-3 py-3 rounded-md hover:bg-pink-700 shadow hover:scale-105 transition-all duration-200 ease-in-out">
                                      üõí Buy Now
                                    </a>
                                  </div>
                                </div>
                            </div>
                      
                            <!-- Product Card 3 -->
                            <div class="flex-shrink-0 w-[600px] w-full h-72 flex items-center gap-6 p-4 bg-white dark:bg-gray-800 rounded-xl ">
                                <!-- Image -->
                                <img src="../assets/product1.jpg" alt="Sunscreen" class="w-72 h-64" />
                        
                                <!-- Info Section -->
                                <div class="w-full h-full flex flex-col justify-between">
  
                                  <!-- Top Badge -->
                                  <span class="text-xs bg-pink-100 text-pink-700 px-2 py-0.5 rounded-full font-semibold animate-bounce mb-1 inline-block">
                                    üíñ Fan Favorite
                                  </span>                                  
                                
                                  <!-- Product Info -->
                                  <div>
                                    <h4 class="text-xl font-bold text-pink-700 text-left">HydraLock Barrier Cream</h4>
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mt-1 text-left">
                                        Restores moisture barrier and blocks dust particles.
                                    </p>
                                    <span class="inline-flex items-center text-[11px] font-medium bg-yellow-50 text-yellow-800 px-2 py-0.5 rounded-full mt-2 w-fit">
                                        ‚òÄÔ∏è Skin Type: Dry
                                      </span>                                                                        
                                  </div>
                                
                                  <!-- Divider -->
                                  <div class="border-t border-gray-300 my-3"></div>
                                
                                  <!-- Price + Reward + Button -->
                                  <div class="flex items-center justify-between">
                                    <div class="flex flex-col">
                                      <span class="text-pink-600 font-semibold text-base">‚Çπ499</span>
                                    </div>
                                    <a href="https://www.amazon.in/dp/example1" target="_blank" class="bg-pink-600 text-white text-sm px-3 py-3 rounded-md hover:bg-pink-700 shadow hover:scale-105 transition-all duration-200 ease-in-out">
                                      üõí Buy Now
                                    </a>
                                  </div>
                                </div>
                            </div>
                      
                          </div>
                        </div>
                    </div>
                      
                    <!-- Skin Forecast Section -->
                    <div class="bento-card flex-1 transform hover:scale-[1.02] transition-all duration-300">
                        <div class="card-header">
                            <span class="card-emoji animate-bounce">üå¶Ô∏è</span>
                            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Skin Forecast</h3>
                        </div>
                        <div class="space-y-4" id="skin-forecast">
                            <!-- Forecast will be injected by JS -->
                        </div>
                    </div>
                </div>

                <!-- AM, PM & Hydration Plan -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 p-4">
                    <!-- ‚òÄÔ∏è AM Plan -->
                    <div class=" bento-card flex-1 bg-white shadow-md rounded-2xl p-4 transform hover:scale-[1.02] transition-transform duration-300 ease-in-out">
                    <div class="card-header">
                            <span class="card-emoji animate-bounce">‚òÄÔ∏è</span>
                            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">AM Plan</h3>
                    </div>
                      <ul id="am-tasks" class="list-disc pl-5 text-left space-y-2">
                        <li class="task">Cleanse with Vitamin C Foaming Wash</li>
                        <li class="task">Apply HydraLock Barrier Cream</li>
                        <li class="task">Use GlowGuard SPF 50</li>
                      </ul>
                        <button onclick="completeTask('am-tasks'); if (window.gamification) window.gamification.checkAndRewardPlan('am-tasks');" class="mt-5 bg-purple-200 hover:bg-purple-300 text-purple-900 font-semibold py-2 px-4 rounded-full transition-all">Tap to Login</button>
                    </div>
                  
                    <!-- üåô PM Plan -->
                    <div class=" bento-card bg-white shadow-md rounded-2xl p-4">
                        <div class="card-header">
                            <span class="card-emoji animate-bounce">üåô</span>
                            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">PM Plan</h3>
                            </div>
                      <ul id="pm-tasks" class="list-disc pl-5 text-left space-y-2">
                        <li class="task">Double cleanse with makeup remover</li>
                        <li class="task">Apply Retinol Repair Serum</li>
                        <li class="task">Finish with Overnight Repair Moisturizer</li>
                      </ul>
                      <button onclick="completeTask('pm-tasks'); if (window.gamification) window.gamification.checkAndRewardPlan('pm-tasks');" class="mt-5 bg-purple-200 hover:bg-purple-300 text-purple-900 font-semibold py-2 px-4 rounded-full transition-all">Tap to Login</button>
                    </div>
                  
                    <!-- üíß Hydration -->
                    <div class=" bento-card bg-white shadow-md rounded-2xl p-4">
                        <div class="card-header">
                            <span class="card-emoji animate-bounce">üíß</span>
                            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Hydration</h3>
                            </div>
                      <ul id="hydration-tasks" class="list-disc pl-5 text-left space-y-2">
                        <li class="task">Drink 2L water today</li>
                        <li class="task">Use Hyaluronic Hydration Gel</li>
                        <li class="task">Track hydration in app</li>
                      </ul>
                      <button onclick="completeTask('hydration-tasks'); if (window.gamification) window.gamification.checkAndRewardPlan('hydration-tasks');" onchange="completeDailyTask('routine')" class="mt-5 px-6 py-2 rounded-full text-purple-900 font-semibold bg-white/10 border border-white/30 backdrop-blur-md hover:bg-white/20 hover:shadow-lg transition-all duration-300">Tap to Login</button>
                    </div>
                </div>

                <!-- Why protection matter -->
                <div class="flex items-center justify-center">
                    <div class="bento-card bg-white shadow-md rounded-2xl p-4 transform hover:scale-[1.02] transition-transform duration-300 ease-in-out flex flex-col justify-between w-full max-w-2xl mx-auto">
                        <div class="card-header mb-4 flex items-center gap-2">
                        <span class="card-emoji animate-bounce">üß†</span>
                        <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Why Pollution Matters</h3>
                        </div>
                    
                        <div class="relative w-full h-40 overflow-hidden" id="flip-card-container">
                        <!-- Cards will be injected here -->
                        </div>
                    </div>
                </div>

                <!-- Clash Check and Suggested Fix Bento Boxes -->
                <div class="flex flex-col md:flex-row gap-6 w-full max-w-6xl mx-auto mt-10">
  
                    <!-- Clash Check Bento Box -->
                    <div id="clashCheckBox" class="bento-card flex-1 bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg border-l-4 border-red-400 transform transition-transform duration-1000 hover:scale-[1.02]">
                      <!-- Header -->
                      <div class="card-header flex items-center gap-3 mb-4">
                        <span class="text-2xl animate-bounce-slow">üß™</span>
                        <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Clash Check</h3>
                    </div>
                      
                      <!-- Product Selection Form -->
                      <div class="space-y-4 text-sm">
                        <!-- Product 1 Upload -->
                                  <div>
                          <label class="block mb-1 font-medium text-gray-700 dark:text-gray-200">Upload Product 1 Image</label>
                          <input type="file" id="product1-upload" accept="image/*" class="w-full p-2 border rounded-lg">
                          <div id="preview-product1" class="mt-2 flex gap-2"></div>
                          <div id="product1-ingredients" class="mt-2 text-xs text-gray-500 hidden"></div>
                                  </div>
                  
                        <!-- Product 2 Upload -->
                        <div>
                          <label class="block mb-1 font-medium text-gray-700 dark:text-gray-200">Upload Product 2 Image</label>
                          <input type="file" id="product2-upload" accept="image/*" class="w-full p-2 border rounded-lg">
                          <div id="preview-product2" class="mt-2 flex gap-2"></div>
                          <div id="product2-ingredients" class="mt-2 text-xs text-gray-500 hidden"></div>
                                </div>
                        
                        <!-- Skin Type Selector -->
                                  <div>
                          <label class="block mb-1 font-medium text-gray-700 dark:text-gray-200">Select Your Skin Type</label>
                          <div class="flex flex-wrap gap-2 mt-2">
                            <button class="skin-btn" data-type="Oily">üõ¢Ô∏è Oily</button>
                            <button class="skin-btn" data-type="Dry">üíß Dry</button>
                            <button class="skin-btn" data-type="Combination">üåó Combo</button>
                            <button class="skin-btn" data-type="Sensitive">üåø Sensitive</button>
                                  </div>
                          <input type="hidden" name="skinType" id="selectedSkinType" />
                                </div>
                        
                        <!-- Clash Warning -->
                        <div id="clashWarning" class="text-red-600 font-semibold bg-red-50 border border-red-200 p-3 rounded-lg hidden transition-all duration-700">
                          ‚ö†Ô∏è Clash Detected! Your products may not be safe together.
                        </div>
                  
                        <!-- CTA Button -->
                        <button 
                          id="checkClashBtn"
                          class="mt-4 w-full bg-red-200 hover:bg-red-300 text-white font-semibold py-2 px-4 rounded-xl shadow-md transition-all duration-1000 transform hover:scale-105 active:scale-95">
                          üîç Check Clash
                        </button>
                  
                        <button 
                          id="seeFixBtn"
                          class="mt-4 w-full bg-purple-200 hover:bg-purple-300 text-white font-semibold py-2 px-4 rounded-xl shadow-md transition-all duration-1000 transform hover:scale-105 active:scale-95 hidden">
                          üöë See Suggested Fix
                        </button>
                      </div>
                    </div>
                      
                    <!-- Suggested Fix Bento Box -->
                    <div id="suggestedFixBox" class="bento-card flex-1 transform hover:scale-[1.02] transition-all duration-300 bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg">
                      <div class="card-header flex items-center gap-2 mb-4">
                        <span class="card-emoji animate-bounce text-2xl">üõ†</span>
                        <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Suggested Fix</h3>
                      </div>
                      <div id="fixProductList" class="space-y-4">
                        <div class="text-gray-500 italic">Upload product images and check for clashes to see suggested fixes here.</div>
                      </div>
                    </div>
                </div>

                <!-- Today's Protection Checklist -->
                <div class="bento-card transform hover:scale-[1.02] transition-all duration-300 text-sm max-w-2xl w-full items-center justify-center">
                    <div class="card-header flex items-center gap-2 mb-2">
                        <span class="card-emoji text-lg animate-bounce">üìã</span>
                        <h3 class="text-xl font-bold text-gray-800">Today's Protection Checklist</h3>
                    </div>
                                  <div>
                        <div class="space-y-4">
                            <div class="flex items-center p-3 bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-300 transform hover:scale-105">
                                <input type="checkbox" class="w-5 h-5 text-blue-600 rounded" onchange="updateChecklist(this)">
                                <span class="ml-3">Apply sunscreen (SPF 50+)</span>
                                <span class="ml-auto text-sm text-gray-500">+10 ‚ú®</span>
                                  </div>
                            <div class="flex items-center p-3 bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-300 transform hover:scale-105">
                                <input type="checkbox" class="w-5 h-5 text-blue-600 rounded" onchange="updateChecklist(this)">
                                <span class="ml-3">Drink 6 glasses of water</span>
                                <span class="ml-auto text-sm text-gray-500">+5 ‚ú®</span>
                                </div>
                            <div class="flex items-center p-3 bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-300 transform hover:scale-105">
                                <input type="checkbox" class="w-5 h-5 text-blue-600 rounded" onchange="updateChecklist(this)">
                                <span class="ml-3">Use antioxidant serum</span>
                                <span class="ml-auto text-sm text-gray-500">+15 ‚ú®</span>
                            </div>
                        </div>
                    </div>
                </div>    


            </div>
        </div>

        <!-- GlowPro Page -->
        <div id="glowpro-page" class="page-content" style="display: none;">
            <div class="max-w-6xl mx-auto p-8">
                
                <!-- Monthly Plans -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <!-- Free Plan -->
                <div class="bento-card transform hover:scale-[1.02] transition-all duration-300">
                    <div class="card-header">
                        <span class="card-emoji animate-bounce">‚ú®</span>
                            <h3 class="text-xl font-bold text-gray-800">Free</h3>
                        </div>
                    <div class="card-content">
                            <div class="text-3xl font-bold text-gray-800 mb-4">‚Çπ0<span class="text-lg text-gray-600">/month</span></div>
                            <ul class="space-y-3 mb-6">
                                <li class="flex items-center">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    Basic skin analysis
                                </li>
                                <li class="flex items-center">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    Daily skin tracking
                                </li>
                                <li class="flex items-center">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    Basic product recommendations
                                </li>
                                <li class="flex items-center text-gray-400">
                                    <span class="mr-2">√ó</span>
                                    AI-powered analysis
                                </li>
                                <li class="flex items-center text-gray-400">
                                    <span class="mr-2">√ó</span>
                                    Personalized routines
                                </li>
                            </ul>
                            <button class="w-full bg-gray-100 text-gray-800 py-2 rounded-lg font-semibold hover:bg-gray-200 transition-colors">
                                Current Plan
                            </button>
                        </div>
                    </div>

                    <!-- Basic Plan -->
                    <div class="bento-card transform hover:scale-[1.02] transition-all duration-300">
                        <div class="card-header">
                            <span class="card-emoji animate-bounce">üí´</span>
                            <h3 class="text-xl font-bold text-gray-800">Basic</h3>
                        </div>
                        <div class="card-content">
                            <div class="text-3xl font-bold text-gray-800 mb-4">‚Çπ199<span class="text-lg text-gray-600">/month</span></div>
                            <ul class="space-y-3 mb-6">
                                <li class="flex items-center">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    Advanced skin analysis
                                </li>
                                <li class="flex items-center">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    Unlimited skin tracking
                                </li>
                                <li class="flex items-center">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    Detailed product recommendations
                                </li>
                                <li class="flex items-center">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    Basic AI analysis
                                </li>
                                <li class="flex items-center text-gray-400">
                                    <span class="mr-2">√ó</span>
                                    Personalized routines
                                </li>
                            </ul>
                            <button class="w-full bg-gradient-to-r from-pink-500 to-purple-500 text-white py-2 rounded-lg font-semibold hover:from-pink-600 hover:to-purple-600 transition-colors">
                                Upgrade Now
                            </button>
                        </div>
                    </div>

                    <!-- Premium Plan -->
                    <div class="bento-card transform hover:scale-[1.02] transition-all duration-300">
                        <div class="card-header">
                            <span class="card-emoji animate-bounce">üíé</span>
                            <h3 class="text-xl font-bold text-gray-800">Premium</h3>
                        </div>
                        <div class="card-content">
                            <div class="text-3xl font-bold text-gray-800 mb-4">‚Çπ899<span class="text-lg text-gray-600">/month</span></div>
                            <ul class="space-y-3 mb-6">
                                <li class="flex items-center">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    Premium skin analysis
                                </li>
                                <li class="flex items-center">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    Unlimited skin tracking
                                </li>
                                <li class="flex items-center">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    Premium product recommendations
                                </li>
                                <li class="flex items-center">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    Advanced AI analysis
                                </li>
                                <li class="flex items-center">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    Personalized routines
                                </li>
                            </ul>
                            <button class="w-full bg-gradient-to-r from-pink-500 to-purple-500 text-white py-2 rounded-lg font-semibold hover:from-pink-600 hover:to-purple-600 transition-colors">
                                Upgrade Now
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Yearly Plan -->
                <div class="bento-card transform hover:scale-[1.02] transition-all duration-300">
                    <div class="card-header">
                        <span class="card-emoji animate-bounce">üëë</span>
                        <h3 class="text-xl font-bold text-gray-800">Yearly Premium</h3>
                    </div>
                    <div class="card-content">
                        <div class="flex items-center justify-between mb-6">
                        <div>
                                <div class="text-3xl font-bold text-gray-800">‚Çπ2,999<span class="text-lg text-gray-600">/year</span></div>
                                <div class="text-green-500 text-sm mt-1">Save 72% compared to monthly</div>
                        </div>
                            <div class="bg-yellow-100 text-yellow-800 px-4 py-2 rounded-lg">
                                Best Value
                            </div>
                        </div>
                        <ul class="space-y-3 mb-6">
                            <li class="flex items-center">
                                <span class="text-green-500 mr-2">‚úì</span>
                                All Premium features
                            </li>
                            <li class="flex items-center">
                                <span class="text-green-500 mr-2">‚úì</span>
                                Priority support
                            </li>
                            <li class="flex items-center">
                                <span class="text-green-500 mr-2">‚úì</span>
                                Exclusive product discounts
                            </li>
                            <li class="flex items-center">
                                <span class="text-green-500 mr-2">‚úì</span>
                                Early access to new features
                            </li>
                            <li class="flex items-center">
                                <span class="text-green-500 mr-2">‚úì</span>
                                Quarterly skin consultation
                            </li>
                        </ul>
                        <button class="w-full bg-gradient-to-r from-yellow-500 to-orange-500 text-white py-2 rounded-lg font-semibold hover:from-yellow-600 hover:to-orange-600 transition-colors">
                            Get Yearly Plan
                        </button>
                        </div>
                    </div>

                <!-- Features Comparison -->
                <div class="bento-card mt-8 transform hover:scale-[1.02] transition-all duration-300">
                    <div class="card-header">
                        <span class="card-emoji animate-bounce">üìä</span>
                        <h3 class="text-xl font-bold text-gray-800">Feature Comparison</h3>
                    </div>
                    <div class="card-content">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b">
                                        <th class="text-left py-3">Features</th>
                                        <th class="text-center py-3">Free</th>
                                        <th class="text-center py-3">Basic</th>
                                        <th class="text-center py-3">Premium</th>
                                        <th class="text-center py-3">Yearly</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b">
                                        <td class="py-3">Skin Analysis</td>
                                        <td class="text-center">Basic</td>
                                        <td class="text-center">Advanced</td>
                                        <td class="text-center">Premium</td>
                                        <td class="text-center">Premium</td>
                                    </tr>
                                    <tr class="border-b">
                                        <td class="py-3">AI Analysis</td>
                                        <td class="text-center">-</td>
                                        <td class="text-center">Basic</td>
                                        <td class="text-center">Advanced</td>
                                        <td class="text-center">Advanced</td>
                                    </tr>
                                    <tr class="border-b">
                                        <td class="py-3">Product Recommendations</td>
                                        <td class="text-center">Basic</td>
                                        <td class="text-center">Detailed</td>
                                        <td class="text-center">Premium</td>
                                        <td class="text-center">Premium</td>
                                    </tr>
                                    <tr class="border-b">
                                        <td class="py-3">Personalized Routines</td>
                                        <td class="text-center">-</td>
                                        <td class="text-center">-</td>
                                        <td class="text-center">‚úì</td>
                                        <td class="text-center">‚úì</td>
                                    </tr>
                                    <tr class="border-b">
                                        <td class="py-3">Priority Support</td>
                                        <td class="text-center">-</td>
                                        <td class="text-center">-</td>
                                        <td class="text-center">-</td>
                                        <td class="text-center">‚úì</td>
                                    </tr>
                                    <tr>
                                        <td class="py-3">Product Discounts</td>
                                        <td class="text-center">-</td>
                                        <td class="text-center">-</td>
                                        <td class="text-center">-</td>
                                        <td class="text-center">‚úì</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                </div>
        </div>

        <!-- Profile Page -->
        <div id="profile-page" class="page-content" style="display: none;">
            <div class="max-w-7xl mx-auto p-8">
                
                <!-- Profile Overview Card -->
                <div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl">
                    <!-- Upper Section with Full-Width Image -->
                    <div class="relative h-48 bg-gradient-to-r from-purple-400 via-pink-500 to-red-500">
                      <!-- Edit Icon in Top Right Corner -->
                      <div class="absolute top-4 right-4 bg-white p-2 rounded-full shadow-md cursor-pointer hover:bg-gray-100 z-10" onclick="openProfileEdit()">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600" viewBox="0 0 20 20" fill="currentColor">
                          <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" />
                        </svg>
                    </div>
                      
                      <!-- Profile Image Overlay (Centered) -->
                      <div class="absolute inset-0 flex items-center justify-center">
                        <div class="w-32 h-32 rounded-full bg-white/20 backdrop-blur-sm border-2 border-white/30 flex items-center justify-center shadow-lg">
                          <img id="profile-card-photo" src="../assets/default-avatar.png" alt="Profile Photo" class="w-28 h-28 rounded-full object-cover border-4 border-white/40 shadow" />
                        </div>
                      </div>
                    </div>
                  
                    <!-- Lower Section -->
                    <div class="p-6">
                      <div class="flex flex-col md:flex-row gap-6">
                        <!-- Left Part - Name and ID -->
                        <div class="flex-1">
                          <h2 class="text-2xl font-bold text-gray-800" id="profile-display-name">Sonal Kumar</h2>
                          <p class="text-gray-600" id="profile-display-username">@sonalkumar</p>
                        </div>
                  
                        <!-- Right Part - Badges -->
                        <div class="flex-1 flex items-center justify-end space-x-4">
                          <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
                              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                            </svg>
                                    </span>
                          <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
                              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                            </svg>
                                    </span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Statistics -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- First Grid: Statistics -->
                <div class="bento-card mb-6 transform hover:scale-[1.02] transition-all duration-300">
                    <div class="card-header">
                        <span class="card-emoji animate-bounce">üß¨</span>
                            <h2 class="text-xl font-bold text-gray-800">Statistics </h2>
                    </div>
                        <div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg">
                                    <h2 class="font-bold text-blue-600 mb-2">üî•<span id="profile-streak-count">0</span></h2>
                                    <p class="text-gray-700">Day Streak</p>
                            </div>
                                <div class="bg-gradient-to-r from-purple-50 to-red-50 p-4 rounded-lg">
                                    <h4 class="font-bold text-purple-600 mb-2">‚ú®<span id="profile-glow-coins">0</span></h4>
                                    <p class="text-gray-700">Glow Coins</p>
                            </div>
                                <div class="bg-gradient-to-r from-purple-50 to-green-50 p-4 rounded-lg">
                                    <h3 class="font-bold text-purple-600 mb-2">üëë Perl</h3>
                                    <p class="text-gray-700">Current League</p>
                                </div>
                                <div class="bg-gradient-to-r from-purple-50 to-blue-50 p-4 rounded-lg">
                                    <h4 class="font-bold text-purple-600 mb-2">üíß<span id="profile-hydration-points">0</span></h4>
                                    <p class="text-gray-700">Hydration</p>
                                </div>
                        </div>
                    </div>
                </div>

                    <!-- Second Grid: Routine Tracker -->
                <div class="bento-card mb-6 transform hover:scale-[1.02] transition-all duration-300">
                    <div class="card-header flex items-center justify-between">
                      <div class="flex items-center gap-2">
                        <span class="card-emoji animate-bounce">üìÖ</span>
                        <h2 class="text-xl font-bold text-gray-800">Routine Tracker</h2>
                      </div>
                      <div class="bg-white p-2 rounded-full shadow-md cursor-pointer hover:bg-gray-100 z-10" onclick="openRoutineEdit()">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600" viewBox="0 0 20 20" fill="currentColor">
                          <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" />
                        </svg>
                      </div>
                    </div>
                    <div class="space-y-4" id="routine-tracker-list">
                      <!-- Routine tracker items will be rendered by JS -->
                    </div>
                  </div>
                </div>

                <!-- Achievement Card -->
                <div class="bento-card mb-6 transform hover:scale-[1.02] transition-all duration-300">
                    <div class="card-header flex items-center gap-3 mb-4">
                        <span class="card-emoji animate-bounce text-2xl">üèÜ</span>
                        <h3 class="text-xl font-bold text-gray-800">Achievements</h3>
                    </div>
                    
                    <div class="space-y-4">
                        <!-- Achievement 1 -->
                        <div class="flex items-center gap-4 group">
                            <div class="flex items-center justify-center text-6xl">
                              üåü
                            </div>
                            <div class="relative flex-1 p-4 bg-gradient-to-b from-yellow-50 to-orange-50 rounded-lg hover:shadow-md transition-all duration-300">
                              <div class="absolute top-3 right-3 bg-white/80 px-2 py-1 rounded-full text-xs font-bold text-yellow-600"><span id="achievement-first-scan-current">0</span>/1</div>
                              <h4 class="font-bold text-yellow-600 h-12 text-left">First Scan</h4>
                              <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-yellow-400 h-2 rounded-full" style="width: 100%"></div>
                            </div>
                            </div>
                            </div>
                        
                        <!-- Achievement 2 -->
                        <div class="flex items-center gap-4 group">
                            <div class="flex items-center justify-center text-6xl">
                              üíß
                            </div>
                            <div class="relative flex-1 p-4 bg-gradient-to-b from-blue-50 to-indigo-50 rounded-lg hover:shadow-md transition-all duration-300">
                              <div class="absolute top-3 right-3 bg-white/80 px-2 py-1 rounded-full text-xs font-bold text-blue-600"><span id="achievement-hydration-current">0</span>/7</div>
                              <h4 class="font-bold text-blue-600 h-12 text-left">Hydration Hero</h4>
                              <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-blue-400 h-2 rounded-full" id="achievement-hydration-bar" style="width: 0%"></div>
                              </div>
                            </div>
                        </div>
                        
                        <!-- Achievement 3 -->
                        <div class="flex items-center gap-4 group">
                            <div class="flex items-center justify-center text-6xl">
                              üõ°Ô∏è
                            </div>
                            <div class="relative flex-1 p-4 bg-gradient-to-b from-green-50 to-teal-50 rounded-lg hover:shadow-md transition-all duration-300">
                              <div class="absolute top-3 right-3 bg-white/80 px-2 py-1 rounded-full text-xs font-bold text-green-600"><span id="achievement-protection-current">0</span>/10</div>
                              <h4 class="font-bold text-green-600 h-12 text-left">Protection Pro</h4>
                              <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-green-400 h-2 rounded-full" id="achievement-protection-bar" style="width: 0%"></div>
                              </div>
                            </div>
                        </div>
                        
                        <!-- Achievement 4 -->
                        <div class="flex items-center gap-4 group">
                            <div class="flex items-center justify-center text-6xl">
                              üî•
                            </div>
                            <div class="relative flex-1 p-4 bg-gradient-to-b from-purple-50 to-pink-50 rounded-lg hover:shadow-md transition-all duration-300">
                              <div class="absolute top-3 right-3 bg-white/80 px-2 py-1 rounded-full text-xs font-bold text-purple-600"><span id="achievement-streak-current">0</span>/7</div>
                              <h4 class="font-bold text-purple-600 h-12 text-left">Streak Master</h4>
                              <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-purple-400 h-2 rounded-full" id="achievement-streak-bar" style="width: 0%"></div>
                              </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Card -->
                <!-- <div class="bento-card transform hover:scale-[1.02] transition-all duration-300">
                    <div class="card-header">
                        <span class="card-emoji animate-bounce">‚öôÔ∏è</span>
                        <h3 class="text-xl font-bold text-gray-800">Settings</h3>
                    </div>
                    <div class="card-content">
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-3 bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-300">
                                <div class="flex items-center">
                                    <span class="text-xl mr-3">üîî</span>
                                    <span>Notifications</span>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-300">
                                <div class="flex items-center">
                                    <span class="text-xl mr-3">üåô</span>
                                    <span>Dark Mode</span>
                                </div>
                                <label class="switch">
                                    <input type="checkbox">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-300">
                                <div class="flex items-center">
                                    <span class="text-xl mr-3">üîí</span>
                                    <span>Privacy Settings</span>
                                </div>
                                <button class="text-blue-600 hover:text-blue-800">Manage</button>
                            </div>
                        </div>
                    </div>
                </div> -->
            </div>
        </div>

        <!-- Shop Page -->
        <div id="shop-page" class="page-content" style="display: none;">
          <div class="max-w-7xl mx-auto p-8">
            <div class="bento-card shop-bento flex flex-col gap-8">
              <!-- Upper Section -->
              <div class="shop-upper-section text-center py-6">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">Welcome Back Glow Seeker</h2>
                <div class="flex items-center justify-center gap-2 text-lg text-gray-600">
                  <span class="text-2xl">üõçÔ∏è</span>
                  <span>Discover products tailored for your skin</span>
                </div>
              </div>
              <!-- Lower Section -->
              <div class="shop-lower-section flex flex-col md:flex-row gap-4 items-center justify-center">
                <input id="shop-search-bar" type="text" placeholder="Search for products, brands, or ingredients..." class="shop-search-bar flex-1 px-6 py-3 rounded-full border border-gray-300 shadow focus:outline-none focus:ring-2 focus:ring-pink-400 text-lg" />
                <select id="shop-filter-bar" class="shop-filter-bar px-4 py-2 rounded-full border border-gray-300 bg-white shadow text-base ml-0 md:ml-2">
                  <option value="all">All</option>
                  <option value="moisturizer">Moisturizer</option>
                  <option value="serum">Serum</option>
                  <option value="sunscreen">Sunscreen</option>
                  <option value="cleanser">Cleanser</option>
                </select>
              </div>
            </div>
            <!-- De-tan Spotlight Carousel -->
            <div id="detan-spotlight" class="w-full mt-10 rounded-2xl p-6" style="background: #EFC9F6;">
              <h2 class="text-2xl md:text-3xl font-bold text-purple-900 mb-6 text-center">De-tan Spotlight</h2>
              <div class="relative">
                <button id="detan-prev" class="absolute left-0 top-1/2 -translate-y-1/2 bg-purple-300 hover:bg-purple-400 text-white rounded-full w-10 h-10 flex items-center justify-center shadow-lg z-10">&#8592;</button>
                <div id="shop-product-results" class="gap-6 justify-center overflow-hidden scroll-smooth"></div>
                <button id="detan-next" class="absolute right-0 top-1/2 -translate-y-1/2 bg-purple-300 hover:bg-purple-400 text-white rounded-full w-10 h-10 flex items-center justify-center shadow-lg z-10">&#8594;</button>
              </div>
            </div>
            <!-- Placeholder for product results -->
            <div class="w-full overflow-x-auto">
                <div id="shop-product-results" class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6"></div>
                <!-- product card will be injected here -->
            </div>
            <!-- For Dry Skin Carousel -->
            <div class="w-full mt-10 rounded-2xl p-6 bg-purple-100 relative">
              <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl md:text-3xl font-bold text-purple-900">For Dry Skin</h2>
                <a href="#" class="text-purple-700 font-semibold hover:underline text-base md:text-lg">See All</a>
              </div>
              <div class="relative">
                <button id="dry-prev" class="absolute left-0 top-1/2 -translate-y-1/2 bg-purple-200 hover:bg-purple-300 text-white rounded-full w-10 h-10 flex items-center justify-center shadow-lg z-10">&#8592;</button>
                <div id="dry-carousel" class="flex gap-6 justify-center overflow-hidden scroll-smooth px-4 py-2"></div>
                <button id="dry-next" class="absolute right-0 top-1/2 -translate-y-1/2 bg-purple-200 hover:bg-purple-300 text-white rounded-full w-10 h-10 flex items-center justify-center shadow-lg z-10">&#8594;</button>
              </div>
            </div>
            <!-- For Oily Skin Carousel -->
            <div class="w-full mt-10 rounded-2xl p-6 bg-purple-100 relative">
              <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl md:text-3xl font-bold text-purple-900">For Oily Skin</h2>
                <a href="#" class="text-purple-700 font-semibold hover:underline text-base md:text-lg">See All</a>
              </div>
              <div class="relative">
                <button id="oily-prev" class="absolute left-0 top-1/2 -translate-y-1/2 bg-purple-200 hover:bg-purple-300 text-white rounded-full w-10 h-10 flex items-center justify-center shadow-lg z-10">&#8592;</button>
                <div id="oily-carousel" class="flex gap-6 justify-center overflow-hidden px-4 py-8 "></div>
                <button id="oily-next" class="absolute right-0 top-1/2 -translate-y-1/2 bg-purple-200 hover:bg-purple-300 text-white rounded-full w-10 h-10 flex items-center justify-center shadow-lg z-10">&#8594;</button>
              </div>
            </div>
            <!-- Targeted Solutions Section -->
            <div class="w-full mt-20">
              <div class="flex flex-col sm:flex-row justify-between items-center gap-6 sm:gap-2">
                <!-- Detan -->
                <div class="flex flex-col items-center flex-1 min-w-[90px]">
                <a href="#detan-spotlight" class="flex flex-col items-center cursor-pointer">
                    <span class="text-7xl">‚òÄÔ∏è</span>
                    <span class="mt-6 text-base font-medium text-gray-700 custom-skin-text">Detan</span>
                </a>
                </div>
                <!-- Hydration -->
                <div class="flex flex-col items-center flex-1 min-w-[90px]">
                  <span class="text-7xl">üíß</span>
                  <span class="mt-6 text-base font-medium text-gray-700 custom-skin-text">Hydration</span>
                </div>
                <!-- Hyperpigmentation -->
                <div class="flex flex-col items-center flex-1 min-w-[90px]">
                    <span class="text-7xl">üßë‚Äçü¶≤</span>
                  <span class="mt-6 text-base font-medium text-gray-700 custom-skin-text">Hyper -</span>
                  <span class="mt-3 text-base font-medium text-gray-700 custom-skin-text">pigmentation</span>
                </div>
                <!-- Anti-Ageing -->
                <div class="flex flex-col items-center flex-1 min-w-[90px]">
                  <span class="text-7xl">‚è≥</span>
                  <span class="mt-6 text-base font-medium text-gray-700 custom-skin-text">Anti-Ageing</span>
                </div>
                <!-- Acne -->
                <div class="flex flex-col items-center flex-1 min-w-[90px]">
                    <span class="text-7xl">ü©π</span>
                  <span class="mt-6 text-base font-bold text-gray-700 custom-skin-text">Acne</span>
                </div>
              </div>
            </div>
            <!-- End Targeted Solutions Section -->
            <!-- Customer Favorites Section -->
            <div class="w-full mt-16">
              <h2 class="text-2xl md:text-3xl font-bold text-purple-900 mb-8 flex items-center gap-2">
                <span>üåü</span> Customer Favorites
              </h2>
              <div id="favorites-carousel" class="flex gap-8 overflow-x-auto scroll-smooth pb-4 hide-scrollbar">
                <!-- Card 1 -->
                <div class="flex-shrink-0 w-72 h-96 bg-white rounded-2xl shadow-md flex flex-col">
                  <div class="h-40 w-full flex items-center justify-center bg-purple-50 rounded-t-2xl">
                    <img src="../assets/product1.png" alt="GlowGuard SPF 50" class="h-28 w-28 object-cover rounded-xl" />
                  </div>
                  <div class="flex-1 flex flex-col justify-center items-center px-4 py-3">
                    <h4 class="font-bold text-lg text-gray-800 text-center">GlowGuard SPF 50</h4>
                    <p class="text-sm text-gray-500 mt-1 text-center">Skin Type: Oily</p>
                  </div>
                  <div class="border-t border-gray-500 mx-4"></div>
                  <div class="flex items-center justify-between px-4 py-3">
                    <span class="text-pink-600 font-semibold text-base">‚Çπ499</span>
                    <a href="https://www.amazon.in/dp/example1" target="_blank" class="bg-pink-500 text-white text-sm px-4 py-1.5 rounded-md hover:bg-pink-600 transition">Buy</a>
                  </div>
                </div>
                <!-- Card 2 -->
                <div class="flex-shrink-0 w-72 h-96 bg-white rounded-2xl shadow-md flex flex-col">
                  <div class="h-40 w-full flex items-center justify-center bg-blue-50 rounded-t-2xl">
                    <img src="../assets/product1.png" alt="HydraLock Barrier Cream" class="h-28 w-28 object-cover rounded-xl" />
                  </div>
                  <div class="flex-1 flex flex-col justify-center items-center px-4 py-3">
                    <h4 class="font-bold text-lg text-gray-800 text-center">HydraLock Barrier Cream</h4>
                    <p class="text-sm text-gray-500 mt-1 text-center">Skin Type: Dry</p>
                  </div>
                  <div class="border-t border-gray-500 mx-4"></div>
                  <div class="flex items-center justify-between px-4 py-3">
                    <span class="text-pink-600 font-semibold text-base">‚Çπ599</span>
                    <a href="https://www.amazon.in/dp/example2" target="_blank" class="bg-pink-500 text-white text-sm px-4 py-1.5 rounded-md hover:bg-pink-600 transition">Buy</a>
                  </div>
                </div>
                <!-- Card 3 -->
                <div class="flex-shrink-0 w-72 h-96 bg-white rounded-2xl shadow-md flex flex-col">
                  <div class="h-40 w-full flex items-center justify-center bg-pink-50 rounded-t-2xl">
                    <img src="../assets/product1.png" alt="Vitamin C Shield Serum" class="h-28 w-28 object-cover rounded-xl" />
                  </div>
                  <div class="flex-1 flex flex-col justify-center items-center px-4 py-3">
                    <h4 class="font-bold text-lg text-gray-800 text-center">Vitamin C Shield Serum</h4>
                    <p class="text-sm text-gray-500 mt-1 text-center">Skin Type: All</p>
                  </div>
                  <div class="border-t border-gray-500 mx-4"></div>
                  <div class="flex items-center justify-between px-4 py-3">
                    <span class="text-pink-600 font-semibold text-base">‚Çπ799</span>
                    <a href="https://www.amazon.in/dp/example3" target="_blank" class="bg-pink-500 text-white text-sm px-4 py-1.5 rounded-md hover:bg-pink-600 transition">Buy</a>
                  </div>
                </div>
                <!-- Card 4 -->
                <div class="flex-shrink-0 w-72 h-96 bg-white rounded-2xl shadow-md flex flex-col">
                  <div class="h-40 w-full flex items-center justify-center bg-yellow-50 rounded-t-2xl">
                    <img src="../assets/product1.png" alt="Gentle Foam Cleanser" class="h-28 w-28 object-cover rounded-xl" />
                  </div>
                  <div class="flex-1 flex flex-col justify-center items-center px-4 py-3">
                    <h4 class="font-bold text-lg text-gray-800 text-center">Gentle Foam Cleanser</h4>
                    <p class="text-sm text-gray-500 mt-1 text-center">Skin Type: Oily</p>
                  </div>
                  <div class="border-t border-gray-500 mx-4"></div>
                  <div class="flex items-center justify-between px-4 py-3">
                    <span class="text-pink-600 font-semibold text-base">‚Çπ349</span>
                    <a href="https://www.amazon.in/dp/example4" target="_blank" class="bg-pink-500 text-white text-sm px-4 py-1.5 rounded-md hover:bg-pink-600 transition">Buy</a>
                  </div>
                </div>
                <!-- Card 5 -->
                <div class="flex-shrink-0 w-72 h-96 bg-white rounded-2xl shadow-md flex flex-col">
                  <div class="h-40 w-full flex items-center justify-center bg-green-50 rounded-t-2xl">
                    <img src="../assets/product1.png" alt="Tea Tree Face Wash" class="h-28 w-28 object-cover rounded-xl" />
                  </div>
                  <div class="flex-1 flex flex-col justify-center items-center px-4 py-3">
                    <h4 class="font-bold text-lg text-gray-800 text-center">Tea Tree Face Wash</h4>
                    <p class="text-sm text-gray-500 mt-1 text-center">Skin Type: Combination</p>
                  </div>
                  <div class="border-t border-gray-500 mx-4"></div>
                  <div class="flex items-center justify-between px-4 py-3">
                    <span class="text-pink-600 font-semibold text-base">‚Çπ299</span>
                    <a href="https://www.amazon.in/dp/example5" target="_blank" class="bg-pink-500 text-white text-sm px-4 py-1.5 rounded-md hover:bg-pink-600 transition">Buy</a>
                  </div>
                </div>
                <!-- Card 6 -->
                <div class="flex-shrink-0 w-72 h-96 bg-white rounded-2xl shadow-md flex flex-col">
                  <div class="h-40 w-full flex items-center justify-center bg-red-50 rounded-t-2xl">
                    <img src="../assets/product1.png" alt="Charcoal Peel-Off Mask" class="h-28 w-28 object-cover rounded-xl" />
                  </div>
                  <div class="flex-1 flex flex-col justify-center items-center px-4 py-3">
                    <h4 class="font-bold text-lg text-gray-800 text-center">Charcoal Peel-Off Mask</h4>
                    <p class="text-sm text-gray-500 mt-1 text-center">Skin Type: Oily</p>
                  </div>
                  <div class="border-t border-gray-500 mx-4"></div>
                  <div class="flex items-center justify-between px-4 py-3">
                    <span class="text-pink-600 font-semibold text-base">‚Çπ399</span>
                    <a href="https://www.amazon.in/dp/example6" target="_blank" class="bg-pink-500 text-white text-sm px-4 py-1.5 rounded-md hover:bg-pink-600 transition">Buy</a>
                  </div>
                </div>
              </div>
            </div>
            <!-- End Customer Favorites Section -->
          </div>
        </div>

        <!-- Existing content -->
        <div id="home-page" class="page-content">
            <!-- Bento Grid 1 -->
            <div class="bento-grid">
                <!-- AI Dermatologist -->
                <div class="bento-card small grid grid-rows-[auto_1fr_auto] h-64 p-4 rounded-lg shadow-md bg-white">
                    <div class="card-header">
                        <span class="card-emoji">üß™</span>
                        <h3 class="text-xl font-bold text-gray-800">AI Dermatologist</h3>
                    </div>
                    <div>
                        <p class="text-gray-800">Your personal AI skincare coach Always Honest, Always Here.</p>
                    </div>
                    <div class="mt-4 text-center">
                        <button id="ai-derm-bento" class="mt-4 w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300">
                            üß™ Get AI Derm
                        </button>
                    </div>
                </div>

                <!-- Pollution Impact Scanner -->
                <div class="bento-card small grid grid-rows-[auto_1fr_auto] h-64 p-4 rounded-lg shadow-md bg-white">
                    <div class="card-header">
                        <span class="card-emoji">üå§Ô∏è</span>
                        <h3 class="text-xl font-bold text-gray-800">Glow Shield</h3>
    </div>
                    <div>
                        <p class="text-gray-800">See what pollution's doing to your glow‚Äîbefore it shows.</p>
        </div>
                    <div class="mt-4 text-center">
                        <button id="open-glowshield" class="mt-4 w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300">
                            üõ°Ô∏è Get Glow Status
                        </button>
                    </div>
                </div>

                <!-- Skin Goals -->
                <div class="bento-card small flex flex-col justify-between">
                    <div class="card-header">
                        <span class="card-emoji">üéØ</span>
                        <h3 class="text-xl font-bold text-gray-800">Skin Goals</h3>
                    </div>
                    <div>
                        <div class="goals-container space-y-4">
                            <!-- Scan Goal -->
                            <div data-goal="scan">
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center space-x-3">
                                        <span class="goal-emoji text-2xl">üì∏</span>
                                        <span class="goal-text">Earn 10 XP</span>
                                    </div>
                                    <div class="goal-chest closed" data-goal="scan">
                                        <span class="chest-emoji text-2xl">üéÅ</span>
                                    </div>
                                </div>
                                <div class="progress-bar relative w-full bg-gray-200 rounded-full overflow-hidden" style="height: 30px;">
                                    <div class="progress-bar-fill absolute top-0 left-0 bg-purple-500 rounded-l-full" style="width: 0%; height: 100%;"></div>
                                    <div class="goal-progress absolute inset-0 flex items-center justify-center text-sm z-10 text-base">0/10</div>
                                </div>
                                
                            </div>

                            <!-- Hydration Goal -->
                            <div data-goal="hydration">
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center space-x-3">
                                        <span class="goal-emoji text-2xl cursor-pointer hover:scale-110 transition-transform">üíß</span>
                                        <span class="goal-text">Earn 10 XP for Hydrated</span>
                </div>
                                    <div class="goal-chest closed" data-goal="hydration">
                                        <span class="chest-emoji text-2xl">üéÅ</span>
            </div>
                    </div>
                                <div class="progress-bar relative w-full bg-gray-200 rounded-full overflow-hidden" style="height: 30px;">
                                    <div class="progress-bar-fill absolute top-0 left-0 bg-purple-500 rounded-l-full" style="width: 0%; height: 100%;"></div>
                                    <div class="goal-progress absolute inset-0 flex items-center justify-center text-sm z-10 text-base">0/10</div>
                </div>
                            </div>
                                
                            <!-- Pollution Report Goal -->
                            <div data-goal="pollution">
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center space-x-3">
                                        <span class="goal-emoji text-2xl">üå§Ô∏è</span>
                                        <span class="goal-text">Check Pollution Report</span>
                                    </div>
                                    <div class="goal-chest closed" data-goal="pollution">
                                        <span class="chest-emoji text-2xl">üéÅ</span>
                                    </div>
                                </div>
                                <div class="progress-bar relative w-full bg-gray-200 rounded-full overflow-hidden" style="height: 30px;">
                                    <div class="progress-bar-fill absolute top-0 left-0 bg-purple-500 rounded-l-full" style="width: 0%; height: 100%;"></div>
                                    <div class="goal-progress absolute inset-0 flex items-center justify-center text-sm z-10 text-base">Not Completed Yet</div>
            </div>
        </div>
                </div>
            </div>
                
                </div>       
            </div>

            <!-- Bento Grid 2 -->
            <div class="bento-grid2">
                <div class="bento-card flex-1 mb-6 transform hover:scale-[1.02] transition-all duration-300">
                    <div class="card-header mb-4 flex items-center gap-2">
                      <span class="card-emoji animate-bounce text-2xl">üß¥</span>
                      <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">Recommended Products</h3>
                    </div>
                  
                    <!-- Horizontal Scroll Carousel -->
                    <div class="overflow-x-auto scroll-smooth hide-scrollbar px-5 py-6">
                      <div id="product-carousel" class="flex gap-6 pr-2">
                  
                        <!-- Product Card 1 -->
                        <div class="flex-shrink-0 w-[600px] w-full h-72 flex items-center gap-6 p-4 bg-white dark:bg-gray-800 rounded-xl ">
                          <!-- Image -->
                          <img src="../assets/product1.jpg" alt="Sunscreen" class="w-72 h-64" />
                  
                          <!-- Info Section -->
                          <div class="w-full h-full flex flex-col justify-between">

                            <!-- Top Badge -->
                            <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full font-semibold animate-pulse mb-1 inline-block">
                              üåü Best Seller
                            </span>
                          
                            <!-- Product Info -->
                            <div>
                              <h4 class="text-xl font-bold text-pink-700 text-left">GlowGuard SPF 50</h4>
                              <p class="text-sm text-gray-600 dark:text-gray-300 mt-1 text-left">
                                Great for oily and acne-prone skin. Broad-spectrum protection.
                              </p>
                              <span class="inline-flex items-center text-[11px] font-medium bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full mt-2 w-fit shadow-sm">
                                üíß Oily
                              </span>                                  
                            </div>
                          
                            <!-- Divider -->
                            <div class="border-t border-gray-300 my-3"></div>
                          
                            <!-- Price + Reward + Button -->
                            <div class="flex items-center justify-between">
                              <div class="flex flex-col">
                                <span class="text-pink-600 font-semibold text-base">‚Çπ499</span>
                              </div>
                              <a href="https://www.amazon.in/dp/example1" target="_blank" class="bg-pink-600 text-white text-sm px-3 py-3 rounded-md hover:bg-pink-700 shadow hover:scale-105 transition-all duration-200 ease-in-out">
                                üõí Buy Now
                              </a>
                            </div>
                          </div>
                        </div>
                  
                        <!-- Product Card 2 -->
                        <div class="flex-shrink-0 w-[600px] w-full h-72 flex items-center gap-6 p-4 bg-white dark:bg-gray-800 rounded-xl ">
                            <!-- Image -->
                            <img src="../assets/de-tan.png" alt="Sunscreen" class="w-72 h-64" />
                    
                            <!-- Info Section -->
                            <div class="w-full h-full flex flex-col justify-between">

                              <!-- Top Badge -->
                              <span class="text-xs bg-red-100 text-red-700 px-2 py-0.5 rounded-full font-semibold animate-pulse mb-1 inline-block">
                                üî• Hot Pick
                              </span>                                  
                            
                              <!-- Product Info -->
                              <div>
                                <h4 class="text-xl font-bold text-pink-700 text-left">Vitamin C Shield Serum</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-300 mt-1 text-left">
                                    Fights pollution and boosts glow. Use in the morning routine.
                                </p>
                                <span class="inline-flex items-center text-[11px] font-medium bg-green-50 text-green-700 px-2 py-0.5 rounded-full mt-2 w-fit">
                                    üåøCombination
                                  </span>                                                                       
                              </div>
                            
                              <!-- Divider -->
                              <div class="border-t border-gray-300 my-3"></div>
                            
                              <!-- Price + Reward + Button -->
                              <div class="flex items-center justify-between">
                                <div class="flex flex-col">
                                  <span class="text-pink-600 font-semibold text-base">‚Çπ499</span>
                                </div>
                                <a href="https://www.amazon.in/dp/example1" target="_blank" class="bg-pink-600 text-white text-sm px-3 py-3 rounded-md hover:bg-pink-700 shadow hover:scale-105 transition-all duration-200 ease-in-out">
                                  üõí Buy Now
                                </a>
                              </div>
                            </div>
                        </div>
                  
                        <!-- Product Card 3 -->
                        <div class="flex-shrink-0 w-[600px] w-full h-72 flex items-center gap-6 p-4 bg-white dark:bg-gray-800 rounded-xl ">
                            <!-- Image -->
                            <img src="../assets/product1.jpg" alt="Sunscreen" class="w-72 h-64" />
                    
                            <!-- Info Section -->
                            <div class="w-full h-full flex flex-col justify-between">

                              <!-- Top Badge -->
                              <span class="text-xs bg-pink-100 text-pink-700 px-2 py-0.5 rounded-full font-semibold animate-bounce mb-1 inline-block">
                                üíñ Fan Favorite
                              </span>                                  
                            
                              <!-- Product Info -->
                              <div>
                                <h4 class="text-xl font-bold text-pink-700 text-left">HydraLock Barrier Cream</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-300 mt-1 text-left">
                                    Restores moisture barrier and blocks dust particles.
                                </p>
                                <span class="inline-flex items-center text-[11px] font-medium bg-yellow-50 text-yellow-800 px-2 py-0.5 rounded-full mt-2 w-fit">
                                    ‚òÄÔ∏è Dry
                                  </span>                                                                        
                              </div>
                            
                              <!-- Divider -->
                              <div class="border-t border-gray-300 my-3"></div>
                            
                              <!-- Price + Reward + Button -->
                              <div class="flex items-center justify-between">
                                <div class="flex flex-col">
                                  <span class="text-pink-600 font-semibold text-base">‚Çπ499</span>
                                </div>
                                <a href="https://www.amazon.in/dp/example1" target="_blank" class="bg-pink-600 text-white text-sm px-3 py-3 rounded-md hover:bg-pink-700 shadow hover:scale-105 transition-all duration-200 ease-in-out">
                                  üõí Buy Now
                                </a>
                              </div>
                            </div>
                        </div>
                  
                      </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <script src="../skin-plugin.js"></script>
    <script src="../static/js/gamification.js"></script>
    <script src="../static/js/glowbot.js"></script>
    <script src="../static/js/goals.js"></script>
    <script src="../static/js/glowshield.js"></script>

    <!-- Carousel Script -->
    <!-- <script>
        let productIndex = 0;
        const productCarousel = document.getElementById("product-carousel");
        const totalProducts = productCarousel.children.length;
      
        function updateCarousel() {
          productCarousel.style.transform = `translateX(-${productIndex * 100}%)`;
        }
    
        setInterval(() => {
          productIndex = (productIndex + 1) % totalProducts;
          updateCarousel();
        }, 5000);
    </script> -->

    <script>
        function resetAMPMIfNewDay() {
            const today = new Date().toDateString();
            const last = localStorage.getItem("lastReset");

            if (today !== last) {
                localStorage.setItem("amCompleted", "false");
                localStorage.setItem("pmCompleted", "false");
                localStorage.setItem("lastReset", today);
                completionTracker.am = false;
                completionTracker.pm = false;
            }
            }

            resetAMPMIfNewDay();

        const completionTracker = {
            am: localStorage.getItem("amCompleted") === "true",
            pm: localStorage.getItem("pmCompleted") === "true"
            };
        function getGlowCoins() {
            return parseInt(localStorage.getItem("glowCoins") || '0');
            }

        function addGlowCoins(amount) {
            const current = getGlowCoins();
            const updated = current + amount;
            localStorage.setItem("glowCoins", updated);
            updateGlowCoinDisplay();
            }

        function updateGlowCoinDisplay() {
            const el = document.querySelector('.glow-coin-count');
            if (el) el.textContent = getGlowCoins();
            }

        document.addEventListener('DOMContentLoaded', () => {
            updateGlowCoinDisplay(); // ü™ô update emoji counter
            });


    </script>

    <!-- product carousel for recommended products -->
    <script>
        const apiKey = '1750030828c7204e4c73d2305ed627e1'; // replace with your OpenWeatherMap API key
        const city = 'Ludhiana'; // or make it dynamic
        const forecastContainer = document.getElementById('skin-forecast');
      
        fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`)
          .then(res => res.json())
          .then(data => {
            const humidity = data.main.humidity;
            const items = [];
      
            if (humidity > 70) {
              items.push({ icon: '‚ö†Ô∏è', text: 'Likely Acne Flare in 2 days' });
              items.push({ icon: 'üíß', text: 'Cause: High humidity in your area' });
              items.push({ icon: 'üí°', text: 'Advice: Use a light, oil-free moisturizer' });
            } else {
              items.push({ icon: '‚úÖ', text: 'No major skin concerns today' });
            }
      
            items.forEach(item => {
              const div = document.createElement('div');
              div.className = 'flex items-start bg-white dark:bg-gray-800 p-3 rounded-lg shadow-sm';
              div.innerHTML = `<span class="text-2xl mr-3">${item.icon}</span><div class="text-gray-800 dark:text-gray-100 font-semibold">${item.text}</div>`;
              forecastContainer.appendChild(div);
            });
          })
          .catch(err => console.error("Weather error:", err));
    </script>


    <!-- open glowshield tab when click the button -->
    <script>
        document.getElementById('open-glowshield').addEventListener('click', function () {
            document.getElementById('icon-glowshield').click();
        });
    </script>
    
    <!-- fetch the pollution data through sheild button -->
    <script>
        async function fetchPollutionData() {
            const apiKey = "1750030828c7204e4c73d2305ed627e1"; // ‚Üê Replace with your actual OpenWeatherMap API key
            const lat = 28.6139; // Use actual user location if available
            const lon = 77.2090;
        
            try {
                // Fetch current weather data
                const weatherRes = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`);
                const weatherData = await weatherRes.json();
        
                const humidity = weatherData.main.humidity;
                const uvIndex = weatherData.uvi || "N/A";
        
                // Fetch air quality data
                const airRes = await fetch(`https://api.openweathermap.org/data/2.5/air_pollution?lat=${lat}&lon=${lon}&appid=${apiKey}`);
                const airData = await airRes.json();
        
                const aqi = airData.list[0].main.aqi;
        
                // Update the HTML
                document.getElementById("uv-value").innerText = uvIndex;
                document.getElementById("uv-risk").innerText = uvIndex > 7 ? "High" : "Moderate";
        
                document.getElementById("humidity-value").innerText = `${humidity}%`;
                document.getElementById("humidity-risk").innerText = humidity > 70 ? "Humid" : "Comfortable";
        
                document.getElementById("aqi-value").innerText = aqi;
                document.getElementById("aqi-risk").innerText = getAqiLevel(aqi);
            } catch (err) {
                console.error("Error fetching data:", err);
                alert("Failed to fetch pollution data.");
            }
        }
        
        function getAqiLevel(aqi) {
            switch (aqi) {
                case 1: return "Good";
                case 2: return "Fair";
                case 3: return "Moderate";
                case 4: return "Poor";
                case 5: return "Very Poor";
                default: return "Unknown";
            }
        }
    </script>
        
    <!-- to change the greeting text -->
    <script>
        function updateGreeting() {
          const greetingEl = document.getElementById('greeting-text');
          if (!greetingEl) return;
      
          const hour = new Date().getHours();
          let timeOfDay = "Morning";
      
          if (hour >= 12 && hour < 17) {
            timeOfDay = "Afternoon";
          } else if (hour >= 17 && hour < 21) {
            timeOfDay = "Evening";
          } else if (hour >= 21 || hour < 5) {
            timeOfDay = "Night";
          }
      
          greetingEl.textContent = `Good ${timeOfDay}, Glow Seeker!`;
        }
      
        document.addEventListener('DOMContentLoaded', updateGreeting);
    </script>
      
    <!-- for glowbot chatbox-->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const dermCard = document.getElementById('ai-derm-bento');

            dermCard.addEventListener('click', () => {
            if (document.getElementById('glowbot-chatbox')) return;

            const box = document.createElement('div');
            box.id = 'glowbot-chatbox';
            box.innerHTML = `
                <div id="glowbot-chat-header" style="display: flex; justify-content: space-between; align-items: center; background: #eee; padding: 8px 12px; font-weight: bold;">
                üí¨ GlowBot
                <button onclick="document.getElementById('glowbot-chatbox').remove()" style="font-size: 16px; background: transparent; border: none; cursor: pointer;">‚úñ</button>
                </div>
                <div id="glowbot-messages" style="height: 280px; overflow-y: auto; overflow-x: hidden; padding: 12px; font-size: 14px; box-sizing: border-box; display: flex; flex-direction: column; gap: 6px;"></div>
                <div id="glowbot-input" style="display: flex; gap: 8px; padding: 8px;">
                <input type="text" id="glowbot-user-input" placeholder="Ask your skin question..." class="flex-1 p-2 border border-gray-300 rounded-lg" />
                <button id="glowbot-send" class="bg-purple-600 text-white px-4 py-1.5 rounded hover:bg-purple-700">Send</button>
                </div>
            `;
            box.style.position = 'fixed';
            box.style.bottom = '20px';
            box.style.right = '20px';
            box.style.width = '320px';
            box.style.background = '#fff';
            box.style.border = '1px solid #ccc';
            box.style.borderRadius = '10px';
            box.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
            box.style.zIndex = '9999';
            document.body.appendChild(box);

            setTimeout(() => document.getElementById('glowbot-user-input').focus(), 100);

            document.getElementById('glowbot-send').addEventListener('click', handleGlowBotMessage);
            document.getElementById('glowbot-user-input').addEventListener('keydown', e => {
                if (e.key === 'Enter') handleGlowBotMessage();
            });
        });

            async function handleGlowBotMessage(customInput = null) {
                const input = document.getElementById('glowbot-user-input');
                const messages = document.getElementById('glowbot-messages');
                const userMsg = customInput || input.value.trim();
                if (!userMsg) return;

                const userDiv = document.createElement('div');
                userDiv.innerHTML = `<div style="text-align:right; margin-bottom: 4px;">
                    <span style="background:#e9d5ff; padding:6px 10px; border-radius:12px; display:inline-block;">${userMsg}</span>
                </div>`;
                messages.appendChild(userDiv);
                input.value = '';

                const botDiv = document.createElement('div');
                botDiv.innerHTML = `<div style="margin-bottom: 6px;">
                    <span style="background:#f3f4f6; padding:6px 10px; border-radius:12px; display:inline-block;">Typing...</span>
                </div>`;
                messages.appendChild(botDiv);

                try {
                    // Build minimal history from the DOM (last ~10 turns)
                    const historyNodes = messages.querySelectorAll('span');
                    const history = [];
                    historyNodes.forEach((node, idx) => {
                        const text = node.textContent || '';
                        const isUser = node.parentElement && node.parentElement.parentElement && node.parentElement.parentElement.style.textAlign === 'right';
                        if (text && !/Typing.../.test(text)) {
                            history.push({ role: isUser ? 'user' : 'assistant', content: text });
                        }
                    });

                    const res = await fetch('/api/ai-derm/chat', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ messages: history.slice(-10), profile: profileData })
                    });
                    const text = await res.text();
                    let data; try { data = JSON.parse(text); } catch { data = null; }
                    if (!res.ok || !data || !data.success) throw new Error((data && data.error) || 'AI error');

                    const reply = data.reply || { type: 'answer', text: 'Sorry, I could not understand.' };
                    if (reply.type === 'question') {
                        botDiv.innerHTML = `<div style="margin-bottom: 6px;">
                            <span style=\"background:#fff; padding:6px 10px; border-radius:12px; display:inline-block;\">${reply.text}</span>
                        </div>`;
                        if (Array.isArray(reply.options) && reply.options.length) {
                            showOptionButtons(reply.options);
                        }
                    } else {
                        botDiv.innerHTML = `<div style="margin-bottom: 6px;">
                            <span style=\"background:#fff; padding:6px 10px; border-radius:12px; display:inline-block;\">${reply.text}</span>
                        </div>`;
                        if (reply.plan && Array.isArray(reply.plan)) {
                            const plan = document.createElement('div');
                            plan.className = 'text-sm text-gray-600 mt-2';
                            plan.innerHTML = `<ul class=\"list-disc pl-5\">${reply.plan.map(s => `<li>${s}</li>`).join('')}</ul>`;
                            messages.appendChild(plan);
                        }
                        if (reply.cautions && Array.isArray(reply.cautions)) {
                            const caut = document.createElement('div');
                            caut.className = 'text-xs text-red-600 mt-2';
                            caut.innerHTML = `<ul class=\"list-disc pl-5\">${reply.cautions.map(s => `<li>${s}</li>`).join('')}</ul>`;
                            messages.appendChild(caut);
                        }
                    }
                } catch (e) {
                    botDiv.innerHTML = `<div style=\"margin-bottom: 6px;\"><span style=\"background:#fff; padding:6px 10px; border-radius:12px; display:inline-block;\">Sorry, the AI service is unavailable.</span></div>`;
                    console.error(e);
                } finally {
                    messages.scrollTo({ top: messages.scrollHeight, behavior: 'smooth' });
                }
            }
        });

        function showOptionButtons(options) {
            const messages = document.getElementById('glowbot-messages');
            const buttonWrap = document.createElement('div');
            buttonWrap.className = "flex flex-wrap gap-2 mt-2";

            options.forEach(option => {
                const btn = document.createElement('button');
                btn.className = "bg-purple-100 text-purple-800 px-3 py-1 rounded hover:bg-purple-200 transition text-sm";
                btn.innerText = option;
                btn.onclick = () => {
                    handleGlowBotMessage(option);
                    buttonWrap.remove(); // remove buttons after click
                };
                buttonWrap.appendChild(btn);
            });

            messages.appendChild(buttonWrap);
            messages.scrollTop = messages.scrollHeight;
        }

    </script>

    <!-- for sidebar navigation-->
    <script>
        // Sidebar navigation logic
        const pages = ['home', 'Goals', 'Glow Sheild', 'GlowPro', 'profile', 'shop'];
        function setActiveIcon(page) {
            pages.forEach(p => {
                document.getElementById('icon-' + p).classList.remove('active-icon');
            });
            document.getElementById('icon-' + page).classList.add('active-icon');
        }
        async function loadPage(page) {
            setActiveIcon(page);
            const module = await import(`./static/js/${page}.js`);
            module.render(document.getElementById('main-content'));
        }
        pages.forEach(page => {
            document.getElementById('icon-' + page).addEventListener('click', () => loadPage(page));
        });
        // Load home by default
        loadPage('home');
        
        // Add Quick Scan button functionality
        document.addEventListener('DOMContentLoaded', function() {
            const quickScanBtn = document.getElementById('quick-scan-btn');
            if (quickScanBtn) {
                quickScanBtn.addEventListener('click', function() {
                    // Add visual feedback
                    this.classList.add('clicked');
                    setTimeout(() => {
                        this.classList.remove('clicked');
                    }, 150);
                    
                    // The button is created dynamically in skin-plugin.js, so we need to wait for it
                    setTimeout(() => {
                        const skinScanBtns = document.querySelectorAll('button');
                        const skinScanBtn = Array.from(skinScanBtns).find(btn => 
                            btn.textContent && btn.textContent.includes('Indian Skin Analysis')
                        );
                        if (skinScanBtn) {
                            // Add visual feedback to the target button too
                            skinScanBtn.classList.add('clicked');
                            setTimeout(() => {
                                skinScanBtn.classList.remove('clicked');
                            }, 150);
                            
                            skinScanBtn.click();
                        }
                    }, 100); // Reduced time for faster response
                });
            }
        });

    </script>

    <!-- for checklist-->
    <script>
        function updateChecklist(el) {
            if (!el.checked) return;

            const label = el.nextElementSibling?.textContent?.toLowerCase() || '';
            if (label.includes("sunscreen")) gamification.addDailyXP(10, 'checklist');
            else if (label.includes("water")) {
            gamification.addDailyXP(5, 'checklist');
            gamification.addHydrationXP(5, 'checklist');
            }
            else if (label.includes("serum")) gamification.addDailyXP(15, 'checklist');

            gamification.updateStreak();
            updateGoalBars();
        }

        // üåü Connect XP with progress bars
        window.updateGoalBars = function () {
            const goals = {
                scan: gamification.dailyXP,
                hydration: gamification.hydrationXP
            };

            for (const [goal, value] of Object.entries(goals)) {
                const container = document.querySelector(`[data-goal="${goal}"]`);
                if (!container) continue;

                const bar = container.querySelector('.progress-bar-fill');
                const label = container.querySelector('.goal-progress');
                const chest = container.querySelector('.goal-chest');

                const max = 10;
                const percent = Math.min(100, (value / max) * 100);

                if (bar) bar.style.width = `${percent}%`;
                if (label) label.textContent = `${value}/10`;

                if (value >= 10 && chest?.classList.contains('closed')) {
                chest.classList.remove('closed');
                chest.classList.add('open');
                chest.innerHTML = '<span class="chest-emoji text-2xl animate-bounce">üéâ</span>';
                }
            }
            };



        window.updateChecklist = function (checkbox) {
            if (!checkbox.checked) return;
            const task = checkbox.nextElementSibling?.textContent.toLowerCase();

            if (task.includes("sunscreen")) gamification.addDailyXP(10, 'checklist');
            else if (task.includes("water")) {
            gamification.addDailyXP(5, 'checklist');
            gamification.addHydrationXP(5, 'checklist');
            }
            else if (task.includes("serum")) gamification.addDailyXP(15, 'checklist');

            gamification.updateStreak();
            // ‚úÖ Immediately reflect the XP in goals section
            if (typeof window.updateGoalBars === 'function') {
                window.updateGoalBars();
            }
        };


        // ‚úÖ Wait for DOM + then call updateUI
        document.addEventListener('DOMContentLoaded', () => {
            gamification.updateUI();
        });

        // ‚úÖ Attach tasks manually for AM/PM, checklist, etc.
        window.completeDailyTask = (type) => {
            console.log("‚úÖ completeTask called with:", taskId);
            gamification.addDailyXP(1, type);
            if (type === 'routine' || type === 'hydration') {
            gamification.addHydrationXP(1, type);
            }
            gamification.updateStreak();
        };


        window.completeTask = function(taskId) {
            console.log("‚úÖ Task completed:", taskId);

            // Strike-through the task visually
            const tasks = document.querySelectorAll(`#${taskId} .task`);
            tasks.forEach(task => task.classList.add('line-through', 'text-green-600'));

            // XP & Coin logic
            if (typeof gamification !== 'undefined') {
            gamification.addDailyXP(1, 'routine');  // Increase XP
            gamification.addGlowCoin(1);            // Add Glow Coin

            // UI Update
            if (typeof gamification.updateUI === 'function') gamification.updateUI();
            if (typeof updateGoalBars === 'function') updateGoalBars();
            } else {
            console.warn("‚ùå gamification not defined");
            }
        };

        
        
    </script>

    <!-- for sidebar navigation-->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sidebarButtons = document.querySelectorAll('.sidebar-icon');
            const pages = document.querySelectorAll('.page-content');
            
            // Function to show a specific page and update active button
            function showPage(targetPage) {
                // Hide all pages
                pages.forEach(page => {
                    page.style.display = 'none';
                });
                
                // Show target page
                const targetPageElement = document.getElementById(`${targetPage}-page`);
                if (targetPageElement) {
                    targetPageElement.style.display = 'block';
                }
                
                // Update active state
                sidebarButtons.forEach(btn => btn.classList.remove('active-icon'));
                document.getElementById(`icon-${targetPage}`).classList.add('active-icon');
            }
        
            // Initialize with home page
            showPage('home');
            
            // Add event listeners to sidebar buttons
            sidebarButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetPage = this.getAttribute('data-page').toLowerCase();
                    showPage(targetPage);
                });
            });
        });
    </script>
    
    <!-- for quick scan button-->
    <!-- <script>
    // ... existing code ...

    // Add this function to handle Quick Scan click
    function initiateSkinScan() {
        // Find the skin scan button created by skin-plugin.js
        const skinScanBtns = document.querySelectorAll('button');
        const skinScanBtn = Array.from(skinScanBtns).find(btn => 
            btn.textContent && btn.textContent.includes('Indian Skin Analysis')
        );
        
        if (skinScanBtn) {
            // Add visual feedback
            skinScanBtn.classList.add('clicked');
            setTimeout(() => {
                skinScanBtn.classList.remove('clicked');
            }, 150);
            
            // Trigger the click event
            skinScanBtn.click();
        } else {
            // If button not found, create and trigger it
            const event = new Event('DOMContentLoaded');
            document.dispatchEvent(event);
            
            // Wait for button to be created and then click it
            setTimeout(() => {
                const newSkinScanBtns = document.querySelectorAll('button');
                const newSkinScanBtn = Array.from(newSkinScanBtns).find(btn => 
                    btn.textContent && btn.textContent.includes('Indian Skin Analysis')
                );
                if (newSkinScanBtn) {
                    newSkinScanBtn.click();
                }
            }, 100);
        }
    }

    // ... existing code ...
    </script> -->

    <!-- Add this before the closing body tag -->
    <!-- <div id="camera-modal" class="camera-modal">
        <div class="camera-container">
            <button class="close-camera" onclick="closeCamera()">√ó</button>
            <div class="camera-view">
                <video id="camera-preview" autoplay playsinline></video>
            </div>
            <button class="capture-btn" onclick="capturePhoto()">Capture Photo</button>
        </div>
    </div> -->

    <!-- <script>
        // Camera functionality
        let stream = null;
        const cameraModal = document.getElementById('camera-modal');
        const cameraPreview = document.getElementById('camera-preview');

        async function openCamera() {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'user',
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    } 
                });
                cameraPreview.srcObject = stream;
                cameraModal.style.display = 'flex';
            } catch (err) {
                console.error('Error accessing camera:', err);
                alert('Could not access camera. Please make sure you have granted camera permissions.');
            }
        }

        function closeCamera() {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
            }
            cameraModal.style.display = 'none';
        }

        async function capturePhoto() {
            const canvas = document.createElement('canvas');
            canvas.width = cameraPreview.videoWidth;
            canvas.height = cameraPreview.videoHeight;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(cameraPreview, 0, 0);
            
            // Convert to base64
            const imageData = canvas.toDataURL('image/jpeg');
            
            // Close camera
            closeCamera();
            
            // Navigate to GlowShield page
            document.getElementById('icon-glowshield').click();
            
            // Update product recommendations based on the captured image
            updateProductRecommendations(imageData);
        }

        function updateProductRecommendations(imageData) {
            // Here you would typically send the image to your backend for analysis
            // For now, we'll simulate some recommendations
            const productCarousel = document.getElementById('product-carousel');
            
            // Clear existing products
            productCarousel.innerHTML = '';
            
            // Add new products based on "analysis"
            const products = [
                {
                    name: "HydraLock Barrier Cream",
                    description: "Perfect for your skin type. Provides 24-hour hydration.",
                    price: "‚Çπ599",
                    image: "/assets/product1.jpg"
                },
                {
                    name: "Vitamin C Shield Serum",
                    description: "Brightens and protects your skin from environmental damage.",
                    price: "‚Çπ799",
                    image: "/assets/product2.jpg"
                },
                {
                    name: "GlowGuard SPF 50",
                    description: "Essential for your skin's daily protection.",
                    price: "‚Çπ499",
                    image: "/assets/product3.jpg"
                }
            ];
            
            products.forEach(product => {
                const productDiv = document.createElement('div');
                productDiv.className = 'min-w-full flex items-center gap-6 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md';
                productDiv.innerHTML = `
                    <img src="${product.image}" alt="${product.name}" class="w-24 h-24 object-cover rounded" />
                    <div class="flex flex-col justify-center h-full">
                        <h4 class="text-lg md:text-xl font-bold text-pink-700">${product.name}</h4>
                        <p class="text-sm md:text-base text-gray-600 dark:text-gray-300 mt-1">
                            ${product.description}
                        </p>
                        <div class="flex flex-col items-start gap-2 mt-2">
                            <button class="text-sm bg-pink-600 text-white px-4 py-1 rounded-full hover:bg-pink-700 transition-all">
                                üí∞ Buy for ${product.price}
                            </button>
                        </div>
                    </div>
                `;
                productCarousel.appendChild(productDiv);
            });
        }

        // Update the initiateSkinScan function
        function initiateSkinScan() {
            openCamera();
        }
    </script> -->

    <!-- for AM, PM & Hydration Plan -->
    <script>
        function completeTask(boxId) {
          const tasks = document.querySelectorAll(`#${boxId} .task:not(.done)`);
          if (tasks.length > 0) {
            const task = tasks[0];
            task.classList.add('done');
          }
        }
    </script>

    <!-- for why protection matter box -->
    <script>
        const cardData = [
            {
                front: "üí® Dull skin?",
                back: "Pollution particles clog pores and reduce glow.",
                tip: "Use a deep-cleansing face wash with antioxidants.",
            },
            {
                front: "üßº Frequent acne?",
                back: "Dust & toxins trigger breakouts and inflammation.",
                tip: "Incorporate niacinamide or tea tree oil in skincare.",
            },
            {
                front: "‚è≥ Premature wrinkles?",
                back: "UV + pollution weaken your collagen barrier.",
                tip: "Apply SPF 50 daily and use vitamin C serum.",
            },
            {
                front: "üé® Uneven tone?",
                back: "Free radicals increase pigmentation and dullness.",
                tip: "Exfoliate regularly with gentle AHA/BHA products.",
            },
            {
                front: "üõ° Barrier damage?",
                back: "Dirty air disrupts your skin's natural defense.",
                tip: "Strengthen barrier with ceramide-rich moisturizers.",
            },
            {
                front: "üåµ Dry patches?",
                back: "Pollution breaks moisture locks ‚Üí dry skin.",
                tip: "Use hydrating masks and avoid harsh cleansers.",
            },
            {
                front: "üìâ Sensitivity rising?",
                back: "Your skin's threshold lowers due to pollutants.",
                tip: "Simplify your routine and use calming ingredients.",
            },
            ];
        
        let currentIndex = 0;
        const container = document.getElementById("flip-card-container");
        
        function createCard(card, index) {
          const cardDiv = document.createElement("div");
          cardDiv.className = "swipe-card absolute top-0 left-0 w-full h-full bg-purple-50 rounded-xl p-4 shadow-md text-center transition-transform duration-300 ease-in-out select-none";
          cardDiv.style.zIndex = index;
        
          cardDiv.innerHTML = `
            <div class="text-xl font-semibold mb-2">${card.front}</div>
            <div class="text-gray-700 text-sm">${card.back}</div>
            <div class="mt-2 p-2 bg-purple-100 text-purple-900 rounded text-xs">${card.tip}</div>
          `;
        
          let startX = 0;
          let currentX = 0;
          let isDragging = false;
        
          cardDiv.addEventListener("mousedown", (e) => {
            startX = e.clientX;
            isDragging = true;
            cardDiv.style.transition = "none";
          });
        
          window.addEventListener("mousemove", (e) => {
            if (!isDragging) return;
            currentX = e.clientX - startX;
            cardDiv.style.transform = `translateX(${currentX}px) rotate(${currentX / 20}deg)`;
          });
        
          window.addEventListener("mouseup", () => {
            if (!isDragging) return;
            isDragging = false;
            cardDiv.style.transition = "transform 0.3s ease";
        
            if (currentX < -100 && currentIndex < cardData.length - 1) {
              cardDiv.style.transform = "translateX(-1000px) rotate(-15deg)";
              setTimeout(() => {
                container.removeChild(cardDiv);
                currentIndex++;
                const newCard = createCard(cardData[currentIndex], currentIndex);
                newCard.style.transform = "translateX(100%)";
                container.appendChild(newCard);
                requestAnimationFrame(() => {
                  newCard.style.transition = "transform 0.3s ease";
                  newCard.style.transform = "translateX(0)";
                });
              }, 300);
            } else if (currentX > 100 && currentIndex > 0) {
              cardDiv.style.transform = "translateX(1000px) rotate(15deg)";
              setTimeout(() => {
                container.removeChild(cardDiv);
                currentIndex--;
                const newCard = createCard(cardData[currentIndex], currentIndex);
                newCard.style.transform = "translateX(-100%)";
                container.appendChild(newCard);
                requestAnimationFrame(() => {
                  newCard.style.transition = "transform 0.3s ease";
                  newCard.style.transform = "translateX(0)";
                });
              }, 300);
            } else {
              cardDiv.style.transform = "translateX(0) rotate(0)";
            }
        
            currentX = 0;
          });
        
          return cardDiv;
        }
        
        container.appendChild(createCard(cardData[currentIndex], currentIndex));
    </script>
        
    <!-- clash check and suggested fix -->
    <script>
        // Ingredient compatibility data (client-side only)
        const compatibilityData = {
          'vitamin c': {
            incompatible: ['retinol', 'aha', 'bha', 'benzoyl peroxide'],
            suggestion: 'Use Vitamin C in the morning and other actives at night',
            alternatives: ['Niacinamide', 'Hyaluronic Acid', 'Vitamin E']
          },
          'retinol': {
            incompatible: ['vitamin c', 'aha', 'bha', 'benzoyl peroxide'],
            suggestion: 'Use Retinol at night and other actives in the morning',
            alternatives: ['Bakuchiol', 'Peptides', 'Niacinamide']
          },
          'niacinamide': {
            incompatible: ['vitamin c'],
            suggestion: 'Use Niacinamide separately from Vitamin C',
            alternatives: ['Zinc', 'Hyaluronic Acid', 'Peptides']
          },
          'aha': {
            incompatible: ['vitamin c', 'retinol', 'bha'],
            suggestion: 'Use AHA on alternate days from other actives',
            alternatives: ['PHA', 'Lactic Acid', 'Enzyme Exfoliants']
          },
          'bha': {
            incompatible: ['vitamin c', 'retinol', 'aha'],
            suggestion: 'Use BHA on alternate days from other actives',
            alternatives: ['Azelaic Acid', 'Sulfur', 'Tea Tree Oil']
          },
          'benzoyl peroxide': {
            incompatible: ['vitamin c', 'retinol'],
            suggestion: 'BP can oxidize other ingredients, use separately',
            alternatives: ['Tea Tree Oil', 'Niacinamide', 'Azelaic Acid']
          }
        };
        
        // Common skincare ingredients
        const commonIngredients = [
          'water', 'glycerin', 'niacinamide', 'hyaluronic acid', 'salicylic acid',
          'benzoyl peroxide', 'retinol', 'vitamin c', 'vitamin e', 'aloe vera',
          'ceramides', 'peptides', 'alpha hydroxy acids', 'beta hydroxy acids',
          'glycolic acid', 'lactic acid', 'mandelic acid', 'azelaic acid',
          'centella asiatica', 'green tea', 'snail mucin', 'propolis',
          'panthenol', 'allantoin', 'zinc oxide', 'titanium dioxide',
          'dimethicone', 'cyclomethicone', 'squalane', 'jojoba oil',
          'rosehip oil', 'tea tree oil', 'lavender oil', 'chamomile',
          'witch hazel', 'calendula', 'licorice root', 'kojic acid',
          'arbutin', 'tranexamic acid', 'bakuchiol', 'caffeine',
          'collagen', 'elastin', 'ferulic acid', 'resveratrol'
        ];
        
        // Skin type selector
        document.addEventListener('DOMContentLoaded', () => {
          document.querySelectorAll('.skin-btn').forEach(btn => {
            btn.addEventListener('click', () => {
              document.querySelectorAll('.skin-btn').forEach(b => b.classList.remove('active'));
              btn.classList.add('active');
              document.getElementById('selectedSkinType').value = btn.dataset.type;
            });
          });
        });
        
        // Image preview functionality
        function handleImagePreview(inputId, previewId, ingredientsId) {
          const input = document.getElementById(inputId);
          const previewContainer = document.getElementById(previewId);
          const ingredientsContainer = document.getElementById(ingredientsId);
        
          input.addEventListener('change', () => {
            previewContainer.innerHTML = '';
            ingredientsContainer.classList.add('hidden');
            const files = Array.from(input.files);
            
            files.forEach(file => {
              const reader = new FileReader();
              reader.onload = (e) => {
                const img = document.createElement('img');
                img.src = e.target.result;
                img.alt = 'Uploaded Image';
                img.classList.add('w-20', 'h-20', 'object-cover', 'rounded-md');
                previewContainer.appendChild(img);
              };
              reader.readAsDataURL(file);
            });
          });
        }
        
        // Initialize image preview handlers
        handleImagePreview('product1-upload', 'preview-product1', 'product1-ingredients');
        handleImagePreview('product2-upload', 'preview-product2', 'product2-ingredients');
        
        // Mock function to analyze image for ingredients
        function analyzeImage(imageFile) {
          // In a real implementation, this would use Tesseract.js or similar
          // For demo, we return mock ingredients based on common products
          
          return new Promise((resolve) => {
            setTimeout(() => {
              // Mock response - returns random ingredients for demo
              const getRandomIngredients = () => {
                const count = 3 + Math.floor(Math.random() * 3);
                const shuffled = [...commonIngredients].sort(() => 0.5 - Math.random());
                return shuffled.slice(0, count);
              };
              
              resolve(getRandomIngredients());
            }, 1000);
          });
        }
        
        // Check clash button click handler
        document.getElementById('checkClashBtn').addEventListener('click', async () => {
          const product1Input = document.getElementById('product1-upload');
          const product2Input = document.getElementById('product2-upload');
          const skinType = document.getElementById('selectedSkinType').value;
        
          if (!product1Input.files.length || !product2Input.files.length) {
            alert('Please upload both product images');
            return;
          }
        
          if (!skinType) {
            alert('Please select your skin type');
            return;
          }
        
          const checkClashBtn = document.getElementById('checkClashBtn');
          checkClashBtn.disabled = true;
          checkClashBtn.textContent = 'üîç Analyzing Ingredients...';
        
          try {
            const formData = new FormData();
            formData.append('product1', product1Input.files[0]);
            formData.append('product2', product2Input.files[0]);
            formData.append('skinType', skinType);
        
            const res = await fetch('/api/clash/analyze', {
              method: 'POST',
              body: formData
            });
            const text = await res.text();
            let data;
            try { data = JSON.parse(text); } catch(e) { data = null; }
            if (!res.ok || !data || data.success === false) {
              console.error('Clash analyze failed:', text);
              throw new Error((data && data.error) || 'Server error');
            }
        
            const ings1 = data.ingredients?.product1 || [];
            const ings2 = data.ingredients?.product2 || [];
            if (ings1.length === 0 && ings2.length === 0) {
              alert('Could not read ingredients from images. Try clearer photos or flat labels.');
            }

            document.getElementById('product1-ingredients').textContent = `Ingredients: ${ings1.slice(0, 15).join(', ') || 'N/A'}`;
            document.getElementById('product1-ingredients').classList.remove('hidden');
            document.getElementById('product2-ingredients').textContent = `Ingredients: ${ings2.slice(0, 15).join(', ') || 'N/A'}`;
            document.getElementById('product2-ingredients').classList.remove('hidden');

            const warningBox = document.getElementById('clashWarning');
            warningBox.classList.remove('hidden');

            if (data.verdict === 'clash') {
              warningBox.innerHTML = `
                ‚ö†Ô∏è Clash Detected!<br>
                <span class="text-sm">Pairs: ${(data.pairs || []).join(', ')}</span><br>
                <span class="text-sm">${data.advice || ''}</span>
              `;
              document.getElementById('seeFixBtn').classList.remove('hidden');
              window.suggestedFix = {
                name: 'Alternative Ingredients',
                reason: data.advice,
                alternatives: data.alternatives,
                skinType: skinType,
                recommendedProducts: data.recommendedProducts || []
              };
            } else {
              warningBox.innerHTML = `
                ‚úÖ Good Combo!<br>
                <span class="text-sm">These products are safe to use together for ${skinType} skin.</span><br>
                <span class="text-sm">Tip: ${data.skinTip || ''}</span>
              `;
              document.getElementById('seeFixBtn').classList.add('hidden');
              window.suggestedFix = null;
            }
          } catch (error) {
            console.error('Error analyzing products:', error);
            alert('Failed to analyze products. Please check your network and try again.');
          } finally {
            checkClashBtn.disabled = false;
            checkClashBtn.textContent = 'üîç Check Clash';
          }
        });

        // Skin type selector binding (ensure value updates)
        document.querySelectorAll('.skin-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            document.querySelectorAll('.skin-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            document.getElementById('selectedSkinType').value = btn.dataset.type;
          });
        });

        // See suggested fix button click handler
        document.getElementById('seeFixBtn').addEventListener('click', () => {
          const suggestedFixBox = document.getElementById('suggestedFixBox');
          const fixProductList = document.getElementById('fixProductList');
        
          suggestedFixBox.scrollIntoView({ behavior: 'smooth' });
        
          if (window.suggestedFix) {
            const { name, reason, alternatives, skinType, recommendedProducts } = window.suggestedFix;
            const productsHtml = (recommendedProducts || []).slice(0, 5).map(p => `
              <div class="p-3 border rounded-xl bg-white shadow-sm flex items-start gap-3">
                <div class="text-2xl">${p.icon || 'üß¥'}</div>
                <div>
                  <p class="font-semibold text-gray-800">${p.name || 'Recommended Product'}</p>
                  <p class="text-sm text-gray-600">${p.desc || 'Suitable for your skin type.'}</p>
                  <p class="text-xs text-gray-500">Use: ${p.usage || 'AM/PM as directed'}</p>
                </div>
              </div>
            `).join('');
        
            fixProductList.innerHTML = `
              <div class="p-4 bg-red-50 border border-red-200 rounded-lg text-red-800 font-medium">
                ‚ö†Ô∏è Ingredient Clash Detected! Better options for ${skinType} skin:
              </div>
              <div class="space-y-3 mt-3">
                <div class="p-4 border rounded-xl bg-gray-50 shadow-sm">
                  <p class="text-gray-800 font-semibold">${name}</p>
                  <p class="text-sm text-gray-600 mt-1">${reason}</p>
                </div>
                <div class="p-4 border rounded-xl bg-green-50 shadow-sm">
                  <p class="text-gray-800 font-semibold">Recommended Alternatives</p>
                  <ul class="text-sm text-gray-600 mt-1 list-disc pl-5">
                    ${(alternatives || []).map(alt => `<li>${alt}</li>`).join('')}
                  </ul>
                </div>
                ${productsHtml ? `<div class=\"space-y-2\">${productsHtml}</div>` : ''}
              </div>
            `;
          }
        });
    </script>    

    <!-- shop page script -->
    <script>
        // Shop Page Script
        (function() {
          const shopSearchBar = document.getElementById('shop-search-bar');
          const shopFilterBar = document.getElementById('shop-filter-bar');
          const shopProductResults = document.getElementById('shop-product-results');
        
          // Example product data
          const products = [
            { name: 'GlowGuard SPF 50', type: 'sunscreen', desc: 'Broad-spectrum protection for all skin types.', icon: 'üß¥' },
            { name: 'HydraLock Barrier Cream', type: 'moisturizer', desc: '24-hour hydration, barrier support.', icon: 'üíß' },
            { name: 'Vitamin C Shield Serum', type: 'serum', desc: 'Brightens and protects from pollution.', icon: 'üçä' },
            { name: 'Gentle Foam Cleanser', type: 'cleanser', desc: 'Removes dirt and excess oil.', icon: 'ü´ß' },
          ];
        
            function renderProducts(filter = 'all', search = '') {
                let filtered = products.filter(p => (filter === 'all' || p.type === filter));

                if (search) {
                    filtered = filtered.filter(p =>
                    p.name.toLowerCase().includes(search.toLowerCase()) ||
                    p.desc.toLowerCase().includes(search.toLowerCase())
                    );
                }

                shopProductResults.innerHTML = filtered.length
                    ? `
                    <div class="w-full">
                        <div class="flex w-max gap-x-6 scroll-smooth snap-x snap-mandatory px-4 py-4">
                            ${filtered.map(p => `
                            <div class="bento-card flex-none w-72 min-w-[18rem] snap-start flex flex-col p-4 bg-white rounded-xl shadow-sm transition hover:shadow-md space-y-3">
                            
                                <!-- Section 1: Image -->
                                <div class="flex justify-center">
                                <img src="${p.image || '../assets/product1.jpg'}" alt="${p.name}" class="w-36 h-36 object-cover rounded-lg shadow-sm" onerror="this.onerror=null;this.src='assets/default-product.jpg';" />
                                </div>

                                <!-- Section 2: Name, Rating, Skin Type -->
                                <div class="text-center">
                                <p class="text-yellow-500 text-sm text-left">‚≠ê ${p.rating || '4.5'}</p>
                                <h4 class="font-bold text-lg text-gray-800 text-left">${p.name}</h4>
                                <p class="text-sm text-gray-500 mt-1 text-left">Skin Type: ${p.skinType || 'All'}</p>
                                </div>

                                <!-- Divider Line -->
                                <div class="border-t border-gray-200 my-2"></div>

                                <!-- Section 3: Price + Add to Cart -->
                                <div class="flex items-center justify-between">
                                <span class="text-pink-600 font-semibold text-base">‚Çπ${p.price || '499'}</span>
                                <button class="bg-pink-500 text-white text-sm px-4 py-1.5 rounded-md hover:bg-pink-600 transition">
                                    Add
                                </button>
                                </div>

                            </div>
                            `).join('')}
                        </div>
                    </div>
                    `
                    : `<div class="text-gray-400 col-span-2 text-center py-6">No products found.</div>`;
                }

                document.getElementById('detan-prev').addEventListener('click', () => {
                document.getElementById('shop-product-results').scrollBy({ left: -300, behavior: 'smooth' });
                });

                document.getElementById('detan-next').addEventListener('click', () => {
                document.getElementById('shop-product-results').scrollBy({ left: 300, behavior: 'smooth' });
                });


          if (shopSearchBar && shopFilterBar) {
            shopSearchBar.addEventListener('input', () => renderProducts(shopFilterBar.value, shopSearchBar.value));
            shopFilterBar.addEventListener('change', () => renderProducts(shopFilterBar.value, shopSearchBar.value));
            renderProducts();
          }
        })();

        // for dry skin
        const drySkinProducts = [
            {
            name: "Hydrating Moisturizer",
            desc: "Soothes and nourishes dry skin all day.",
            image: "../assets/de-tan.png",
            price: 349,
            rating: "4.5",
            link: "https://www.amazon.in/dp/example1"
            },
            {
            name: "Aloe Vera Cream",
            desc: "Natural aloe vera for deep hydration.",
            image: "../assets/de-tan.png",
            price: 299,
            rating: "4.2",
            link: "https://www.amazon.in/dp/example2"
            },
            {
            name: "Shea Butter Lotion",
            desc: "Rich shea butter to lock in moisture.",
            image: "../assets/de-tan.png",
            price: 399,
            rating: "4.7",
            link: "https://www.amazon.in/dp/example3"
            },
            {
            name: "Ceramide Cream",
            desc: "Replenishes dry skin barrier.",
            image: "../assets/de-tan.png",
            price: 449,
            rating: "4.4",
            link: "https://www.amazon.in/dp/example4"
            },
            {
            name: "Vitamin E Serum",
            desc: "Smoothens and brightens dry patches.",
            image: "../assets/de-tan.png",
            price: 349,
            rating: "4.3",
            link: "https://www.amazon.in/dp/example5"
            },
            {
            name: "Honey Balm",
            desc: "Organic balm for extremely dry skin.",
            image: "../assets/de-tan.png",
            price: 499,
            rating: "4.6",
            link: "https://www.amazon.in/dp/example6"
            }
        ];

        const dryCarousel = document.getElementById('dry-carousel');
        let currentStartIndex = 0;
        const cardsPerView = 3;

        function renderCarousel() {
            dryCarousel.innerHTML = '';
            for (let i = 0; i < cardsPerView; i++) {
                const index = (currentStartIndex + i) % drySkinProducts.length;
                const p = drySkinProducts[index];

                 // Add random Bento classes
                const bentoClass =
                i % 3 === 0
                    ? "w-[280px] h-[360px]"
                    : i % 3 === 1
                    ? "w-[320px] h-[420px]"
                    : "w-[300px] h-[390px]";

                dryCarousel.innerHTML += `
                <div class="${bentoClass} flex-none shrink-0 w-64 h-92 bg-gradient-to-br from-purple-50 to-white border border-purple-100 rounded-2xl shadow-md p-5 flex flex-col justify-between hover:scale-[1.015] transition-transform duration-300 ease-in-out">
                    <div class="flex justify-center">
                    <img src="${p.image}" alt="${p.name}"/>
                    </div>

                    <div class="h-3"></div>

                    <div class="flex-1 flex flex-col justify-start">
                    <h4 class="font-semibold text-gray-800 text-lg leading-tight line-clamp-2">${p.name}</h4>
                    <p class="text-sm text-gray-500 mt-1 line-clamp-2">${p.desc}</p>
                    </div>

                    <div class="border-t border-gray-300 my-2 opacity-50"></div>

                    <div class="flex items-start justify-between">
                    <div>
                        <p class="text-black text-base font-bold">‚Çπ${p.price}</p>
                        <p class="text-yellow-500 text-sm mt-1">‚≠ê ${p.rating}</p>
                    </div>
                    <a href="${p.link}" target="_blank" class="bg-purple-600 text-white text-sm px-4 py-1.5 rounded-md hover:bg-purple-700 transition">Buy</a>
                    </div>
                </div>
                `;
            }
            }

        
        document.getElementById('dry-next').addEventListener('click', () => {
            currentStartIndex = (currentStartIndex + 1) % drySkinProducts.length;
            renderCarousel();
        });

        document.getElementById('dry-prev').addEventListener('click', () => {
            currentStartIndex = (currentStartIndex - 1 + drySkinProducts.length) % drySkinProducts.length;
            renderCarousel();
        });

        // Initial render
        renderCarousel();

        // for oily skin
        const oilySkinProducts = [
            {
            name: "Oil-Free Moisturizer",
            desc: "Lightweight formula that hydrates",
            image: "../assets/de-tan.png",
            price: 299,
            rating: "4.6",
            link: "https://www.amazon.in/dp/example1"
            },
            {
            name: "Salicylic Acid Cleanser",
            desc: "Removes excess oil and prevents",
            image: "../assets/de-tan.png",
            price: 349,
            rating: "4.4",
            link: "https://www.amazon.in/dp/example2"
            },
            {
            name: "Niacinamide Serum",
            desc: "Controls sebum and reduces shine.",
            image: "../assets/de-tan.png",
            price: 399,
            rating: "4.7",
            link: "https://www.amazon.in/dp/example3"
            },
            {
            name: "Tea Tree Face Wash",
            desc: "Purifies skin with natural tea tree oil.",
            image: "../assets/de-tan.png",
            price: 249,
            rating: "4.3",
            link: "https://www.amazon.in/dp/example4"
            },
            {
            name: "Charcoal Peel-Off Mask",
            desc: "Deep cleanses pores and removes",
            image: "../assets/de-tan.png",
            price: 299,
            rating: "4.2",
            link: "https://www.amazon.in/dp/example5"
            },
            {
            name: "Oil-Control Gel Cream",
            desc: "Mattifies and refreshes oily skin.",
            image: "../assets/de-tan.png",
            price: 449,
            rating: "4.5",
            link: "https://www.amazon.in/dp/example6"
            }
        ];

        const oilyCarousel = document.getElementById('oily-carousel');
        let oilyStartIndex = 0;
        const oilyCardsPerView = 3;

        function renderOilyCarousel() {
            oilyCarousel.innerHTML = '';
            for (let i = 0; i < oilyCardsPerView; i++) {
            const index = (oilyStartIndex + i) % oilySkinProducts.length;
            const p = oilySkinProducts[index];

            // Add random Bento classes
            const bentoClass =
                i % 3 === 0
                    ? "w-[320px] h-[360px]"
                    : i % 3 === 1
                    ? "w-[320px] h-[360px]"
                    : "w-[320px] h-[360px]";

            oilyCarousel.innerHTML += `
                <div class="${bentoClass} flex-none w-64 h-92 shrink-0 bg-gradient-to-br from-purple-50 to-white border border-purple-100 rounded-2xl shadow-md p-5 flex flex-col justify-between hover:scale-[1.015] transition-transform duration-300 ease-in-out">
                <div class="flex justify-center">
                    <img src="${p.image}" alt="${p.name}"/>
                </div>

                <div class="h-3"></div>

                <div class="flex-1 flex flex-col justify-start">
                    <h4 class="font-semibold text-gray-800 text-lg leading-tight line-clamp-2">${p.name}</h4>
                    <p class="text-sm text-gray-500 mt-1 line-clamp-2">${p.desc}</p>
                </div>

                <div class="border-t border-gray-300 my-2 opacity-50"></div>

                <div class="flex items-start justify-between">
                    <div>
                    <p class="text-black text-base font-bold">‚Çπ${p.price}</p>
                    <p class="text-yellow-500 text-sm mt-1">‚≠ê ${p.rating}</p>
                    </div>
                    <a href="${p.link}" target="_blank" class="bg-purple-600 text-white text-sm px-4 py-1.5 rounded-md hover:bg-purple-700 transition">Buy</a>
                </div>
                </div>
            `;
            }
        }

        document.getElementById('oily-next').addEventListener('click', () => {
            oilyStartIndex = (oilyStartIndex + 1) % oilySkinProducts.length;
            renderOilyCarousel();
        });

        document.getElementById('oily-prev').addEventListener('click', () => {
            oilyStartIndex = (oilyStartIndex - 1 + oilySkinProducts.length) % oilySkinProducts.length;
            renderOilyCarousel();
        });

        // Initial render
        renderOilyCarousel();

        // for customer favorite products carousel
        // Optional: Smooth drag scroll for mouse (like finger swipe)
            const carousel = document.getElementById("favorites-carousel");
                let isDown = false;
                let startX;
                let scrollLeft;

                carousel.addEventListener('mousedown', (e) => {
                isDown = true;
                carousel.classList.add('cursor-grabbing');
                startX = e.pageX - carousel.offsetLeft;
                scrollLeft = carousel.scrollLeft;
                });
                carousel.addEventListener('mouseleave', () => {
                isDown = false;
                carousel.classList.remove('cursor-grabbing');
                });
                carousel.addEventListener('mouseup', () => {
                isDown = false;
                carousel.classList.remove('cursor-grabbing');
                });
                carousel.addEventListener('mousemove', (e) => {
                if (!isDown) return;
                e.preventDefault();
                const x = e.pageX - carousel.offsetLeft;
                const walk = (x - startX) * 1; // scroll speed
                carousel.scrollLeft = scrollLeft - walk;
            });


    </script>

    <!-- call xp function -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
          // üåü Face scan XP trigger
          const scanBtn = document.getElementById('skinScanBtn');
          if (scanBtn) {
            scanBtn.addEventListener('click', () => {
              addXP(1); // Scan = 1 XP
            });
          }
      
          // üíß Hydration checklist buttons
          const hydrationTasks = document.querySelectorAll('#hydration-tasks .task');
          hydrationTasks.forEach(task => {
            task.addEventListener('click', () => {
              task.classList.add('done');
              addHydrationXP(1);
            });
          });
      
          // üõçÔ∏è Product buy buttons
          const buyButtons = document.querySelectorAll('a[href*="amazon.in/dp"]');
          buyButtons.forEach(button => {
            button.addEventListener('click', () => {
              const priceText = button.closest('.product-card')?.querySelector('span.text-base')?.textContent || '‚Çπ499';
              const price = parseInt(priceText.replace(/[^\d]/g, ''), 10);
              awardProductXP(price); // 1 / 5 / 10 XP based on price
            });
          });
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            gamification.updateUI();
            loadProfileData(); // Load saved profile data
        });
    </script>

    <!-- Profile Management Script -->
    <script>
        // Profile data storage
        let profileData = {
            name: 'Sonal Kumar',
            username: '@sonalkumar',
            skinType: 'Combination',
            photo: null
        };

        // Load profile data from localStorage
        function loadProfileData() {
            const saved = localStorage.getItem('profileData');
            if (saved) {
                profileData = { ...profileData, ...JSON.parse(saved) };
                updateProfileDisplay();
            }
        }

        // Save profile data to localStorage
        function saveProfileData() {
            localStorage.setItem('profileData', JSON.stringify(profileData));
        }

        // Update profile display across the app
        function updateProfileDisplay() {
            // Update profile page
            const profileName = document.getElementById('profile-display-name');
            if (profileName) profileName.textContent = profileData.name;
            
            const profileUsername = document.getElementById('profile-display-username');
            if (profileUsername) profileUsername.textContent = profileData.username;

            // Update profile photo in upper section of profile card
            const profileCardPhoto = document.getElementById('profile-card-photo');
            if (profileCardPhoto) {
                if (profileData.photo) {
                    profileCardPhoto.src = profileData.photo;
                } else {
                    profileCardPhoto.src = '../assets/default-avatar.png';
                }
            }

            // Update greeting section
            const greetingText = document.getElementById('greeting-text');
            if (greetingText) {
                const hour = new Date().getHours();
                let timeOfDay = "Morning";
                if (hour >= 12 && hour < 17) timeOfDay = "Afternoon";
                else if (hour >= 17 && hour < 21) timeOfDay = "Evening";
                else if (hour >= 21 || hour < 5) timeOfDay = "Night";
                
                greetingText.textContent = `Good ${timeOfDay}, ${profileData.name}!`;
            }

            // Update profile photo in greeting section
            const greetingAvatar = document.querySelector('.skin-avatar i');
            if (greetingAvatar && profileData.photo) {
                greetingAvatar.style.display = 'none';
                const img = greetingAvatar.parentElement.querySelector('img');
                if (img) {
                    img.src = profileData.photo;
                } else {
                    const newImg = document.createElement('img');
                    newImg.src = profileData.photo;
                    newImg.alt = 'Profile Photo';
                    newImg.className = 'w-full h-full object-cover rounded-full';
                    greetingAvatar.parentElement.appendChild(newImg);
                }
            }

            // Update profile photo in profile page
            const profileAvatar = document.querySelector('#profile-page .skin-avatar i');
            if (profileAvatar && profileData.photo) {
                profileAvatar.style.display = 'none';
                const img = profileAvatar.parentElement.querySelector('img');
                if (img) {
                    img.src = profileData.photo;
                } else {
                    const newImg = document.createElement('img');
                    newImg.src = profileData.photo;
                    newImg.alt = 'Profile Photo';
                    newImg.className = 'w-full h-full object-cover rounded-full';
                    profileAvatar.parentElement.appendChild(newImg);
                }
            }
        }

        // Open profile edit modal
        function openProfileEdit() {
            const modal = document.getElementById('profile-edit-modal');
            if (modal) {
                // Populate form with current data
                document.getElementById('profile-name-input').value = profileData.name;
                document.getElementById('profile-username-input').value = profileData.username;
                document.getElementById('profile-skin-type').value = profileData.skinType;
                
                // Show current photo if exists
                const editPhoto = document.getElementById('profile-edit-photo');
                if (profileData.photo) {
                    editPhoto.src = profileData.photo;
                } else {
                    // Use a data URI for a simple default avatar if image not found
                    editPhoto.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTYiIGhlaWdodD0iOTYiIHZpZXdCb3g9IjAgMCA5NiA5NiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiByeD0iNDgiIGZpbGw9IiNFNUU3RUIiLz4KPHN2ZyB4PSIyNCIgeT0iMjQiIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDQ4IDQ4IiBmaWxsPSJub25lIj4KPHBhdGggZD0iTTI0IDI0QzI2LjIwOTEgMjQgMjggMjIuMjA5MSAyOCAyMEMyOCAxNy43OTA5IDI2LjIwOTEgMTYgMjQgMTZDMjEuNzkwOSAxNiAyMCAxNy43OTA5IDIwIDIwQzIwIDIyLjIwOTEgMjEuNzkwOSAyNCAyNCAyNFoiIGZpbGw9IiM5Q0EzQUYiLz4KPHBhdGggZD0iTTI0IDQ4QzM1LjA0NTcgNDggNDQgMzkuMDQ1NyA0NCAyOEM0NCAxNi45NTQzIDM1LjA0NTcgOCAyNCA4QzEyLjk1NDMgOCA0IDE2Ljk1NDMgNCAyOEM0IDM5LjA0NTcgMTIuOTU0MyA0OCAyNCA0OFoiIGZpbGw9IiM5Q0EzQUYiLz4KPC9zdmc+Cjwvc3ZnPgo=';
                }
                
                modal.classList.remove('hidden');
                modal.classList.add('flex');
            }
        }

        // Close profile edit modal
        function closeProfileEdit() {
            const modal = document.getElementById('profile-edit-modal');
            if (modal) {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }
        }

        // Handle profile photo change
        function handleProfilePhotoChange(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const photoDataUrl = e.target.result;
                    document.getElementById('profile-edit-photo').src = photoDataUrl;
                    profileData.photo = photoDataUrl;
                };
                reader.readAsDataURL(file);
            }
        }

        // Save profile changes
        function saveProfileChanges() {
            // Get form values
            profileData.name = document.getElementById('profile-name-input').value.trim() || profileData.name;
            profileData.username = document.getElementById('profile-username-input').value.trim() || profileData.username;
            profileData.skinType = document.getElementById('profile-skin-type').value || profileData.skinType;

            // Save to localStorage
            saveProfileData();
            
            // Update display across the app
            updateProfileDisplay();
            
            // Close modal
            closeProfileEdit();
            
            // Show success message
            showNotification('Profile updated successfully!', 'success');
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg text-white z-50 ${
                type === 'success' ? 'bg-green-500' : 'bg-blue-500'
            }`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('profile-edit-modal');
            if (event.target === modal) {
                closeProfileEdit();
            }
        });
    </script>
    
    <script>
        window.updateGoalBars = function () {
        const goals = {
            scan: gamification.dailyXP,
            hydration: gamification.hydrationXP
        };

        for (const [goal, value] of Object.entries(goals)) {
            const container = document.querySelector(`[data-goal="${goal}"]`);
            if (!container) continue;

            const bar = container.querySelector('.progress-bar-fill');
            const label = container.querySelector('.goal-progress');
            const chest = container.querySelector('.goal-chest');

            const max = 10;
            const percent = Math.min(100, (value / max) * 100);

            if (bar) bar.style.width = `${percent}%`;
            if (label) label.textContent = `${value}/10`;

            if (value >= 10 && chest && chest.classList.contains('closed')) {
            chest.classList.remove('closed');
            chest.classList.add('open');
            chest.innerHTML = '<span class="chest-emoji text-2xl animate-bounce">üéâ</span>';
            }
        }
        };
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
        if (typeof gamification !== 'undefined') gamification.updateUI();
        if (typeof updateGoalBars === 'function') updateGoalBars();
        if (typeof loadProfileData === 'function') loadProfileData();
        });
    </script>
      
    <!-- Profile Management Script -->
    <script>
        // Profile data storage (using the one declared above)

        // Load profile data from localStorage
        function loadProfileData() {
            const saved = localStorage.getItem('profileData');
            if (saved) {
                profileData = { ...profileData, ...JSON.parse(saved) };
                updateProfileDisplay();
            }
        }

        // Save profile data to localStorage
        function saveProfileData() {
            localStorage.setItem('profileData', JSON.stringify(profileData));
        }

        // Update profile display across the app
        function updateProfileDisplay() {
            // Update profile page
            const profileName = document.getElementById('profile-display-name');
            if (profileName) profileName.textContent = profileData.name;
            
            const profileUsername = document.getElementById('profile-display-username');
            if (profileUsername) profileUsername.textContent = profileData.username;

            // Update greeting section
            const greetingText = document.getElementById('greeting-text');
            if (greetingText) {
                const hour = new Date().getHours();
                let timeOfDay = "Morning";
                if (hour >= 12 && hour < 17) timeOfDay = "Afternoon";
                else if (hour >= 17 && hour < 21) timeOfDay = "Evening";
                else if (hour >= 21 || hour < 5) timeOfDay = "Night";
                
                greetingText.textContent = `Good ${timeOfDay}, ${profileData.name}!`;
            }

            // Update profile photo in greeting section
            const greetingAvatar = document.querySelector('.skin-avatar i');
            if (greetingAvatar) {
                if (profileData.photo) {
                    greetingAvatar.style.display = 'none';
                    let img = greetingAvatar.parentElement.querySelector('img');
                    if (img) {
                        img.src = profileData.photo;
                    } else {
                        img = document.createElement('img');
                        img.src = profileData.photo;
                        img.alt = 'Profile Photo';
                        img.className = 'w-full h-full object-cover rounded-full';
                        greetingAvatar.parentElement.appendChild(img);
                    }
                } else {
                    greetingAvatar.style.display = 'block';
                    const img = greetingAvatar.parentElement.querySelector('img');
                    if (img) img.remove();
                }
            }

            // Update profile photo in profile page
            const profileAvatar = document.querySelector('#profile-page .skin-avatar i');
            if (profileAvatar) {
                if (profileData.photo) {
                    profileAvatar.style.display = 'none';
                    let img = profileAvatar.parentElement.querySelector('img');
                    if (img) {
                        img.src = profileData.photo;
                    } else {
                        img = document.createElement('img');
                        img.src = profileData.photo;
                        img.alt = 'Profile Photo';
                        img.className = 'w-full h-full object-cover rounded-full';
                        profileAvatar.parentElement.appendChild(img);
                    }
                } else {
                    profileAvatar.style.display = 'block';
                    const img = profileAvatar.parentElement.querySelector('img');
                    if (img) img.remove();
                }
            }
        }

        // Open profile edit modal
        function openProfileEdit() {
            const modal = document.getElementById('profile-edit-modal');
            if (modal) {
                // Populate form with current data
                document.getElementById('profile-name-input').value = profileData.name;
                document.getElementById('profile-username-input').value = profileData.username;
                document.getElementById('profile-skin-type').value = profileData.skinType;
                
                // Show current photo if exists
                const editPhoto = document.getElementById('profile-edit-photo');
                if (profileData.photo) {
                    editPhoto.src = profileData.photo;
                } else {
                    // Use a data URI for a simple default avatar if image not found
                    editPhoto.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTYiIGhlaWdodD0iOTYiIHZpZXdCb3g9IjAgMCA5NiA5NiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiByeD0iNDgiIGZpbGw9IiNFNUU3RUIiLz4KPHN2ZyB4PSIyNCIgeT0iMjQiIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDQ4IDQ4IiBmaWxsPSJub25lIj4KPHBhdGggZD0iTTI0IDI0QzI2LjIwOTEgMjQgMjggMjIuMjA5MSAyOCAyMEMyOCAxNy43OTA5IDI2LjIwOTEgMTYgMjQgMTZDMjEuNzkwOSAxNiAyMCAxNy43OTA5IDIwIDIwQzIwIDIyLjIwOTEgMjEuNzkwOSAyNCAyNCAyNFoiIGZpbGw9IiM5Q0EzQUYiLz4KPHBhdGggZD0iTTI0IDQ4QzM1LjA0NTcgNDggNDQgMzkuMDQ1NyA0NCAyOEM0NCAxNi45NTQzIDM1LjA0NTcgOCAyNCA4QzEyLjk1NDMgOCA0IDE2Ljk1NDMgNCAyOEM0IDM5LjA0NTcgMTIuOTU0MyA0OCAyNCA0OFoiIGZpbGw9IiM5Q0EzQUYiLz4KPC9zdmc+Cjwvc3ZnPgo=';
                }
                
                modal.classList.remove('hidden');
                modal.classList.add('flex');
            }
        }

        // Close profile edit modal
        function closeProfileEdit() {
            const modal = document.getElementById('profile-edit-modal');
            if (modal) {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }
        }

        // Handle profile photo change
        function handleProfilePhotoChange(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const photoDataUrl = e.target.result;
                    document.getElementById('profile-edit-photo').src = photoDataUrl;
                    profileData.photo = photoDataUrl;
                };
                reader.readAsDataURL(file);
            }
        }

        // Save profile changes
        function saveProfileChanges() {
            // Get form values
            profileData.name = document.getElementById('profile-name-input').value.trim() || profileData.name;
            profileData.username = document.getElementById('profile-username-input').value.trim() || profileData.username;
            profileData.skinType = document.getElementById('profile-skin-type').value || profileData.skinType;

            // Save to localStorage
            saveProfileData();
            
            // Update display across the app
            updateProfileDisplay();
            
            // Close modal
            closeProfileEdit();
            
            // Show success message
            showNotification('Profile updated successfully!', 'success');
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg text-white z-50 ${
                type === 'success' ? 'bg-green-500' : 'bg-blue-500'
            }`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('profile-edit-modal');
            if (event.target === modal) {
                closeProfileEdit();
            }
        });
    </script>
      
      
      
    
    <!-- Profile Edit Modal -->
    <div id="profile-edit-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white rounded-2xl p-6 w-full max-w-md mx-4">
            <!-- Header -->
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-800">Edit Profile</h3>
                <button onclick="closeProfileEdit()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <!-- Profile Photo Section -->
            <div class="text-center mb-6">
                <div class="relative inline-block">
                    <img id="profile-edit-photo" src="../assets/default-avatar.png" alt="Profile Photo" 
                         class="w-24 h-24 rounded-full object-cover border-4 border-purple-200 mx-auto">
                    <label for="profile-photo-input" class="absolute bottom-0 right-0 bg-purple-600 text-white p-2 rounded-full cursor-pointer hover:bg-purple-700 transition-colors">
                        <i class="fas fa-camera text-sm"></i>
                    </label>
                </div>
                <input type="file" id="profile-photo-input" accept="image/*" class="hidden" onchange="handleProfilePhotoChange(event)">
                <p class="text-sm text-gray-600 mt-2">Click camera icon to change photo</p>
            </div>
            
            <!-- Form Fields -->
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                    <input type="text" id="profile-name-input" placeholder="Enter your name" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                    <input type="text" id="profile-username-input" placeholder="Enter username" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Skin Type</label>
                    <select id="profile-skin-type" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        <option value="">Select skin type</option>
                        <option value="Oily">Oily</option>
                        <option value="Dry">Dry</option>
                        <option value="Combination">Combination</option>
                        <option value="Sensitive">Sensitive</option>
                        <option value="Normal">Normal</option>
                    </select>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex gap-3 mt-6">
                <button onclick="closeProfileEdit()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                    Cancel
                </button>
                <button onclick="saveProfileChanges()" class="flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                    Save Changes
                </button>
            </div>
        </div>
    </div>
    
    <!-- Routine Edit Modal -->
    <div id="routine-edit-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
      <div class="bg-white rounded-2xl p-6 w-full max-w-md mx-4">
        <!-- Header -->
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-xl font-bold text-gray-800">Edit Routine Tracker</h3>
          <button onclick="closeRoutineEdit()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        <!-- Add Item Dropdown -->
        <div class="mb-4 flex gap-2 items-center">
          <select id="routine-add-select" class="flex-1 px-3 py-2 border rounded-lg">
            <option value="">Add a step...</option>
            <option value="üßº|Cleansers">üßº Cleansers</option>
            <option value="üåû|SPF 50++">üåû SPF 50++</option>
            <option value="üåå|Retinol">üåå Retinol</option>
            <option value="üß¥|Moisturizer">üß¥ Moisturizer</option>
            <option value="üßΩ|Exfoliant">üßΩ Exfoliant</option>
            <option value="üíß|Hydrating Serum">üíß Hydrating Serum</option>
            <option value="üçä|Vitamin C">üçä Vitamin C</option>
            <option value="üßñ‚Äç‚ôÄÔ∏è|Face Mask">üßñ‚Äç‚ôÄÔ∏è Face Mask</option>
            <option value="üß¥|Niacinamide">üß¥ Niacinamide</option>
          </select>
          <button onclick="addRoutineItem()" class="px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">Add</button>
        </div>
        <!-- Routine Items -->
        <div class="space-y-4" id="routine-edit-items">
          <!-- JS will populate routine items here -->
        </div>
        <!-- AI Suggestions -->
        <div class="mt-6">
          <h4 class="font-semibold text-gray-700 mb-2">AI Suggestions</h4>
          <ul id="routine-ai-suggestions" class="list-disc list-inside text-gray-600 text-sm space-y-1">
            <!-- JS will populate AI suggestions here -->
          </ul>
        </div>
        <!-- Action Buttons -->
        <div class="flex gap-3 mt-6">
          <button onclick="closeRoutineEdit()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">Cancel</button>
          <button onclick="saveRoutineChanges()" class="flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">Save Changes</button>
        </div>
      </div>
    </div>
    <!-- End Routine Edit Modal -->

    <!-- Routine Tracker Data -->
    <script>
        let routineData = [
          { icon: 'üßº', label: 'Cleansers' },
          { icon: 'üåû', label: 'SPF 50++' },
          { icon: 'üåå', label: 'Retinol' },
          { icon: 'üß¥', label: 'Moisturizer' }
        ];

        // Load routine data from localStorage
        function loadRoutineData() {
          const saved = localStorage.getItem('routineData');
          if (saved) {
            try {
              routineData = JSON.parse(saved);
            } catch (e) {}
          }
        }

        // Save routine data to localStorage
        function saveRoutineData() {
          localStorage.setItem('routineData', JSON.stringify(routineData));
        }

        // Update routine tracker display
        function updateRoutineDisplay() {
          const tracker = document.getElementById('routine-tracker-list');
          if (tracker) {
            tracker.innerHTML = '';
            routineData.forEach(item => {
              tracker.innerHTML += `
                <div class="flex items-center justify-between p-3 bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-300">
                  <div class="flex items-center gap-3">
                    <span class="text-xl">${item.icon}</span>
                    <span class="font-medium text-gray-800">${item.label}</span>
                  </div>
                  <div class="w-64 bg-gray-200 rounded-full h-3">
                    <div class="absolute top-0 left-0 h-2 bg-blue-500 rounded-full" style="width: 0%;"></div>
                  </div>
                </div>
              `;
            });
            // Make scrollable if more than 4 items
            if (routineData.length > 4) {
              tracker.style.maxHeight = '320px';
              tracker.style.overflowY = 'auto';
            } else {
              tracker.style.maxHeight = '';
              tracker.style.overflowY = '';
            }
          }
        }

        // Open routine edit modal
        function openRoutineEdit() {
          const modal = document.getElementById('routine-edit-modal');
          if (modal) {
            renderRoutineEditItems();
            showRoutineAISuggestions();
            modal.classList.remove('hidden');
            modal.classList.add('flex');
          }
        }

        // Render routine items in modal
        function renderRoutineEditItems() {
          const itemsDiv = document.getElementById('routine-edit-items');
          itemsDiv.innerHTML = '';
          routineData.forEach((item, idx) => {
            itemsDiv.innerHTML += `
              <div class="flex gap-2 items-center">
                <input type="text" value="${item.icon}" maxlength="2" class="w-12 px-2 py-1 border rounded text-xl text-center" id="routine-icon-${idx}">
                <input type="text" value="${item.label}" class="flex-1 px-3 py-1 border rounded" id="routine-label-${idx}">
                <button onclick="removeRoutineItem(${idx})" class="px-2 py-1 text-red-600 hover:text-white hover:bg-red-500 rounded transition-colors">Remove</button>
              </div>
            `;
          });
        }

        // Add routine item from dropdown
        function addRoutineItem() {
          const select = document.getElementById('routine-add-select');
          const val = select.value;
          if (val) {
            const [icon, label] = val.split('|');
            routineData.push({ icon, label });
            renderRoutineEditItems();
            select.value = '';
          }
        }

        // Remove routine item
        function removeRoutineItem(idx) {
          routineData.splice(idx, 1);
          renderRoutineEditItems();
        }

        // Save routine changes
        function saveRoutineChanges() {
          // Read values from modal
          const newData = [];
          for (let i = 0; i < routineData.length; i++) {
            const icon = document.getElementById(`routine-icon-${i}`).value || '‚ú®';
            const label = document.getElementById(`routine-label-${i}`).value || 'Routine';
            newData.push({ icon, label });
          }
          routineData = newData;
          saveRoutineData();
          updateRoutineDisplay();
          closeRoutineEdit();
        }

        // Show AI suggestions for routine
        function showRoutineAISuggestions() {
          const suggestions = [
            'Add a gentle exfoliant 2x a week for brighter skin.',
            'Consider a Vitamin C serum in the morning routine.',
            'Night: Use a hydrating mask once a week.',
            "'Don't forget to reapply sunscreen every 2 hours if outdoors.'",
            'Try a niacinamide serum for oil control and brightening.'
          ];
          const ul = document.getElementById('routine-ai-suggestions');
          if (ul) {
            ul.innerHTML = '';
            suggestions.forEach(s => {
              ul.innerHTML += `<li>${s}</li>`;
            });
          }
        }

        // On page load
        loadRoutineData();
        updateRoutineDisplay();
    </script>

    <!-- Close routine edit modal -->
    <script>
        function closeRoutineEdit() {
          const modal = document.getElementById('routine-edit-modal');
          if (modal) {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
          }
        }
        // Expose functions globally for inline HTML onclick
        window.closeRoutineEdit = closeRoutineEdit;
        window.saveRoutineChanges = saveRoutineChanges;
        window.addRoutineItem = addRoutineItem;
        window.removeRoutineItem = removeRoutineItem;

        // Close modal when clicking outside
        document.addEventListener('mousedown', function(event) {
          const modal = document.getElementById('routine-edit-modal');
          if (modal && !modal.classList.contains('hidden') && event.target === modal) {
            closeRoutineEdit();
          }
        });
    </script>

    <script>
    function getCurrentMonthName() {
      return new Date().toLocaleString('default', { month: 'long' }).toUpperCase();
    }
    function getDaysLeftInMonth() {
      const now = new Date();
      return new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate() - now.getDate();
    }
    function updateMonthlyQuestUI() {
      document.getElementById('monthly-quest-month').textContent = getCurrentMonthName();
      document.getElementById('monthly-quest-days-left').textContent = getDaysLeftInMonth();
      // Progress
      const total = 40;
      let completed = parseInt(localStorage.getItem('monthlyQuestCompleted') || '0', 10);
      document.getElementById('monthly-quest-total').textContent = total;
      const percent = Math.min(100, Math.round((completed / total) * 100));
      document.getElementById('monthly-quest-progress-bar').style.width = percent + '%';
    }
    // Call on page load
    updateMonthlyQuestUI();
    // ... existing code ...
    // When a skin goal is completed, increment monthlyQuestCompleted and update UI
    function incrementMonthlyQuestProgress() {
      let completed = parseInt(localStorage.getItem('monthlyQuestCompleted') || '0', 10);
      completed += 1;
      localStorage.setItem('monthlyQuestCompleted', completed);
      updateMonthlyQuestUI();
    }
    window.incrementMonthlyQuestProgress = incrementMonthlyQuestProgress;
    </script>

    <!-- Razorpay Checkout -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
    (function(){
      const planButtons = [
        { selector: '#glowpro-page .bento-card:nth-child(2) button', amount: 19900, label: 'Basic Monthly' },
        { selector: '#glowpro-page .bento-card:nth-child(3) button', amount: 89900, label: 'Premium Monthly' },
        { selector: '#glowpro-page .bento-card + .bento-card + .bento-card + .bento-card button', amount: 299900, label: 'Yearly Premium' }
      ];

      async function fetchKeyId(){
        const res = await fetch('/api/payments/config');
        const data = await res.json();
        if (!res.ok || !data.key_id) throw new Error(data.error || 'Missing key');
        return data.key_id;
      }

      async function createOrder(amount){
        const res = await fetch('/api/payments/create-order', {
          method: 'POST', headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ amount, currency: 'INR', notes: { plan: 'GlowPro' } })
        });
        const data = await res.json();
        if (!res.ok || !data.success) throw new Error(data.error || 'Order failed');
        return data.order;
      }

      async function verifyPayment(payload){
        const res = await fetch('/api/payments/verify', {
          method: 'POST', headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        const data = await res.json();
        return !!(data && data.success && data.verified);
      }

      async function startCheckout(amount, label){
        try{
          const key_id = await fetchKeyId();
          const order = await createOrder(amount);
          const options = {
            key: key_id,
            amount: order.amount,
            currency: order.currency,
            name: 'GlowPro Subscription',
            description: label,
            order_id: order.id,
            handler: async function (response) {
              const ok = await verifyPayment(response);
              if (ok) {
                alert('Payment successful! Your plan is active.');
              } else {
                alert('Payment verification failed.');
              }
            },
            prefill: {},
            theme: { color: '#7c3aed' }
          };
          const rzp = new Razorpay(options);
          rzp.open();
        } catch(e){
          console.error(e);
          alert('Unable to start payment. Please try again.');
        }
      }

      // Bind buttons (guard if DOM not yet present)
      document.addEventListener('click', (e)=>{
        planButtons.forEach(pb => {
          const btn = document.querySelector(pb.selector);
          if (btn && (e.target === btn || btn.contains(e.target))) {
            startCheckout(pb.amount, pb.label);
          }
        });
      });
    })();
    </script>

</body>
</html> 